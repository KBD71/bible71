<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11월 7일 | 성례가 구원에 효과 있게 되는 법</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl px-4 py-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">11월 7일</h1>
            <p class="text-xl text-gray-600 mt-2">성례가 구원에 효과 있게 되는 법</p>
        </header>

        <section id="audio-player-section" class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4">AI요약 듣기</h2>
            <div id="player-ui" class="flex items-center space-x-4">
                <button id="play-pause-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full w-28 transition-opacity duration-300" aria-label="교리 오디오 재생/일시정지" disabled>
                    로딩 중...
                </button>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="player" class="hidden"></div>
            <div id="error-message" class="hidden text-red-500 mt-4"></div>
            <p class="mt-4 text-sm text-gray-500">
                오늘의 자료는 유튜브 영상입니다. '재생' 버튼을 누르면 영상의 음성이 재생됩니다.<br>
                영상 URL: <a href="https://www.youtube.com/watch?v=8Yliz52Eujc" target="_blank" class="text-blue-600 hover:underline">https://www.youtube.com/watch?v=8Yliz52Eujc</a>
            </p>
        </section>
        
        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">소요리문답 91문 / 대요리문답 161문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> 성례가 어떻게 구원에 이르는 효과적인 수단이 됩니까?</p>
                <p><strong class="font-bold">답:</strong> 성례가 구원에 효과적인 수단이 되는 것은, 성례 자체에 어떤 효력이 있어서가 아니며, 또한 성례를 집례하는 자의 경건이나 의도에 달린 것도 아닙니다. 오직 <strong class="text-blue-600">그리스도께서 그것을 제정하신 복</strong>과, <strong class="text-blue-600">믿음으로</strong> 성례를 받는 자들 안에서 역사하시는 <strong class="text-blue-600">성령</strong>으로 말미암는 것입니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">교리 해설</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>
                    성례(세례와 성찬)가 어떻게 구원의 효과적인 수단이 되는지에 대해, 요리문답은 몇 가지 중요한 오해를 바로잡으며 그 근거를 명확히 제시합니다.
                </p>
                <ul class="list-disc list-inside space-y-4 pl-4">
                    <li>
                        <strong class="text-blue-600">성례 자체의 마력(Magic)이 아니다:</strong>
                        성례의 효과는 성례라는 행위 그 자체에서 나오지 않습니다. 이는 "행위 자체로 효력이 발생한다"는 로마 가톨릭의 <strong class="text-blue-600">‘엑스 오페레 오페라토(ex opere operato)’</strong> 견해를 정면으로 반박하는 것입니다. 세례를 받거나 성찬에 참여하는 행위 자체가 마법처럼 자동으로 은혜를 부여하는 것이 아닙니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">집례자의 능력에 달린 것이 아니다:</strong>
                        성례의 효과는 그것을 집례하는 목회자나 사제의 경건함, 신앙심, 또는 의도에 의해 결정되지도 않습니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">효력의 참된 근거: 성령과 믿음:</strong>
                        성례가 효과를 발휘하는 유일한 근거는 <strong class="text-blue-600">성령의 역사하심</strong>과 그것을 <strong class="text-blue-600">믿음으로 받는 수용자</strong>에게 달려있습니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">제정의 권위: 그리스도의 약속:</strong>
                        성령께서 이 수단들을 사용하시는 이유는, <strong class="text-blue-600">그리스도께서 직접 이 성례를 제정</strong>하시고 거기에 "약속의 말씀"을 붙이셨기 때문입니다. 성례는 하나님이 은혜를 주시겠다고 정하신 공식적인 통로입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">믿음 없는 참여의 위험:</strong>
                        만약 믿음이 없는 자가 성례에 참여하면, 유익이 없을 뿐만 아니라 오히려 자기의 죄를 먹고 마시는 것이 되어 심판을 자초하게 됩니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">궁극적인 대상: 택함받은 자들:</strong>
                        이러한 성례의 구원적 효력은 궁극적으로 하나님께서 믿음을 선물로 주시기로 <strong class="text-blue-600">택함받은 자들</strong>에게만 효과를 발휘합니다.
                    </li>
                </ul>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">적용 질문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>성례의 진정한 의미와 그 효력이 오직 성령과 믿음에 달려 있다는 것을 정말로 믿는다면, 혹시 당신이 세례나 성찬에 참여할 때... 그냥 '참석했다'는 사실 자체에 안도감을 느끼고 있지는 않은지, 아니면 그것을 통해 역사하시는 성령님을 의지하며 믿음으로 은혜를 구하고 있는지 돌아보아야 하지 않겠습니까?</p>
            </div>
        </section>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        let player;
        let progressInterval;
        const playPauseButton = document.getElementById('play-pause-button');
        const progressBar = document.getElementById('progress-bar');
        const errorMessageDiv = document.getElementById('error-message');
        const playerUi = document.getElementById('player-ui');
        
        // 11월 7일 자료는 제공된 유튜브 링크 ID를 직접 사용합니다.
        const videoIdForToday = '8Yliz52Eujc';

        function onYouTubeIframeAPIReady() {
            // txt 파일 로드 대신 직접 ID로 플레이어 생성
            try {
                if (!videoIdForToday) {
                    throw new Error('No video ID specified.');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoIdForToday,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                console.error('Error creating player:', error);
            }
        }

        // dcaddr.txt 파일을 로드하는 함수 (참고용으로 남겨둠)
        async function loadVideoForToday_fromFile() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('Audio address file could not be loaded.');
                }
                const data = await response.text();
                const lines = data.split('\n');
                
                const todayKey = '1107'; // 키는 1107로 설정

                // '1107'로 시작하는 줄을 찾습니다 (공백이나 '=' 모두 처리).
                const todayLine = lines.find(line => line.trim().startsWith(todayKey));
                
                if (!todayLine) {
                    throw new Error('not_uploaded');
                }

                // 날짜(키) 부분을 제외하고 나머지(URL)를 추출합니다.
                let url = todayLine.substring(todayKey.length).trim();
                // 맨 앞에 '=' 문자가 있다면 제거합니다.
                if (url.startsWith('=')) {
                    url = url.substring(1).trim();
                }

                const videoId = extractVideoID(url);

                if (!videoId) {
                    throw new Error('Invalid YouTube URL in dcaddr.txt');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                if (error.message === 'not_uploaded') {
                    errorMessageDiv.textContent = '오늘의 AI요약 음성은 아직 업로드 전입니다.';
                } else {
                    errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                    console.error('Error loading video:', error);
                }
            }
        }

        function extractVideoID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function onPlayerReady(event) {
            playPauseButton.disabled = false;
            playPauseButton.textContent = '재생';
            playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
            
            playPauseButton.addEventListener('click', togglePlayPause);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                playPauseButton.textContent = '일시정지';
                playPauseButton.setAttribute('aria-label', '교리 오디오 일시정지');
                progressInterval = setInterval(updateProgressBar, 1000);
            } else {
                playPauseButton.textContent = '재생';
                playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
                clearInterval(progressInterval);
                if (event.data === YT.PlayerState.ENDED) {
                    progressBar.style.width = '100%';
                }
            }
        }

        function togglePlayPause() {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function updateProgressBar() {
            if (player && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
    </script>

</body>
</html>
