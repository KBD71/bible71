<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11월 4일 | 말씀을 구원에 효과 있게 읽고 듣는 법</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl px-4 py-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">11월 4일</h1>
            <p class="text-xl text-gray-600 mt-2">말씀을 구원에 효과 있게 읽고 듣는 법</p>
        </header>

        <section id="audio-player-section" class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4">AI요약 듣기</h2>
            <div id="player-ui" class="flex items-center space-x-4">
                <button id="play-pause-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full w-28 transition-opacity duration-300" aria-label="교리 오디오 재생/일시정지" disabled>
                    로딩 중...
                </button>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="player" class="hidden"></div>
            <div id="error-message" class="hidden text-red-500 mt-4"></div>
            <p class="mt-4 text-sm text-gray-500">
                오늘의 자료는 유튜브 영상입니다. '재생' 버튼을 누르면 영상의 음성이 재생됩니다.<br>
                영상 URL: <a href="https://www.youtube.com/watch?v=LOGyt6i7m-k" target="_blank" class="text-blue-600 hover:underline">https://www.youtube.com/watch?v=LOGyt6i7m-k</a>
            </p>
        </section>
        
        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">소요리문답 90문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> 말씀을 어떻게 읽고 들어야 구원에 이르게 됩니까?</p>
                <p><strong class="font-bold">답:</strong> 말씀을 구원에 이르게 읽고 듣기 위해서는, <strong class="text-blue-600">부지런함</strong>과 <strong class="text-blue-600">준비</strong>와 <strong class="text-blue-600">기도</strong>로써 하며, <strong class="text-blue-600">믿음</strong>으로 받아들이고, 삶에 <strong class="text-blue-600">적용</strong>하며, <strong class="text-blue-600">자기 성찰</strong>을 하고, 마음에 <strong class="text-blue-600">간직</strong>해야 합니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">교리 해설</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>
                    말씀이 구원에 이르는 효과적인 수단이 되기 위해서는, 말씀을 대하는 근본적인 태도와 방법이 필요합니다. 핵심은 말씀을 단순한 정보나 지식이 아니라, 나를 구원하시는 <strong class="text-blue-600">하나님의 살아있는 음성</strong>으로 대하는 것입니다.
                </p>
                <p>
                    이러한 태도는 여러 구체적인 실천으로 나타납니다.
                </p>
                <ul class="list-disc list-inside space-y-4 pl-4">
                    <li>
                        <strong class="text-blue-600">부지런함과 준비, 기도:</strong>
                        첫째, 기계적인 부지런함이 아니라 말씀의 권위를 인정하는 <strong class="text-blue-600">경외심</strong>에서 비롯된 부지런함이 필요합니다. 말씀을 펼치기 전에, 세상적인 염려와 죄된 생각을 내려놓는 '준비'가 필요하며, "내 눈을 열어 주의 율법에서 놀라운 것을 보게 하소서"(시 119:18)와 같이 성령의 조명을 구하는 '기도'가 반드시 동반되어야 합니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">믿음:</strong>
                        말씀을 읽고 들을 때 가장 중요한 것은 <strong class="text-blue-600">믿음</strong>입니다. 말씀이 믿음과 결부되지 않으면 아무 유익이 없습니다(히 4:2). 이는 말씀을 하나님의 진리이자 나를 향한 뜻으로 굳게 받아들이고, 그 말씀이 내 삶 속에서 실제로 이루어질 것을 기대하는 마음입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">적용:</strong>
                        참된 믿음은 반드시 '적용'으로 이어집니다. 말씀을 거울삼아 자신의 생각, 감정, 삶의 방식 중 어긋나는 것을 과감히 고치고, 말씀이 요구하는 방향으로 순종하려 애쓰는 것입니다. 이것이 야고보서가 말하는 '행함이 있는 믿음'입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">자기 성찰:</strong>
                        적용이 외적인 실천이라면, <strong class="text-blue-600">자기 성찰</strong>은 말씀이 내면에서 생명력 있게 역사하는지 점검하는 것입니다. '내가 정말 이 말씀을 믿고 있는가?', '말씀대로 살면서 거룩해지고 있는가?', '하나님이 주시는 위로와 평안을 누리고 있는가?'를 지속적으로 돌아보는 내적인 점검입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">마음에 간직함:</strong>
                        마지막으로 "내가 주께 범죄하지 아니하려 하여 주의 말씀을 내 마음에 두었나이다"(시 119:11)라는 고백처럼, 말씀을 보물처럼 마음판에 새기고 굳게 붙잡아야 합니다.
                    </li>
                </ul>
                <p>
                    이 모든 과정, 즉 부지런함, 준비, 기도, 믿음, 적용, 자기 성찰, 그리고 마음에 간직함을 통해 말씀은 비로소 나를 구원에 이르게 하는 하나님의 효과적인 수단이 됩니다.
                </p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">적용 질문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>당신은 오늘 말씀을 대하면서 이 중에 몇 가지나 진지하게 실천하고 계십니까? 혹시 말씀을 그저 지식을 쌓는 도구나 혹은 마음의 위로를 얻는 정도로만 소비하고 있지는 않으신가요? 오늘 다룬 이 7가지의 태도들을 기억하면서 말씀을 하나님의 살아 있는 음성으로 대하며 그 말씀이 당신의 삶을 실제로 변화시키도록 성령님께 의탁하고 있는지 한번 깊이 돌아보시면 좋겠습니다.</p>
            </div>
        </section>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        let player;
        let progressInterval;
        const playPauseButton = document.getElementById('play-pause-button');
        const progressBar = document.getElementById('progress-bar');
        const errorMessageDiv = document.getElementById('error-message');
        const playerUi = document.getElementById('player-ui');
        
        // 11월 4일 자료는 제공된 유튜브 링크 ID를 직접 사용합니다.
        const videoIdForToday = 'LOGyt6i7m-k';

        function onYouTubeIframeAPIReady() {
            // txt 파일 로드 대신 직접 ID로 플레이어 생성
            try {
                if (!videoIdForToday) {
                    throw new Error('No video ID specified.');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoIdForToday,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                console.error('Error creating player:', error);
            }
        }

        // dcaddr.txt 파일을 로드하는 함수 (참고용으로 남겨둠)
        async function loadVideoForToday_fromFile() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('Audio address file could not be loaded.');
                }
                const data = await response.text();
                const lines = data.split('\n');
                
                const todayKey = '1104'; // 키는 1104로 설정

                // '1104'로 시작하는 줄을 찾습니다 (공백이나 '=' 모두 처리).
                const todayLine = lines.find(line => line.trim().startsWith(todayKey));
                
                if (!todayLine) {
                    throw new Error('not_uploaded');
                }

                // 날짜(키) 부분을 제외하고 나머지(URL)를 추출합니다.
                let url = todayLine.substring(todayKey.length).trim();
                // 맨 앞에 '=' 문자가 있다면 제거합니다.
                if (url.startsWith('=')) {
                    url = url.substring(1).trim();
                }

                const videoId = extractVideoID(url);

                if (!videoId) {
                    throw new Error('Invalid YouTube URL in dcaddr.txt');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                if (error.message === 'not_uploaded') {
                    errorMessageDiv.textContent = '오늘의 AI요약 음성은 아직 업로드 전입니다.';
                } else {
                    errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                    console.error('Error loading video:', error);
                }
            }
        }

        function extractVideoID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regArgsExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function onPlayerReady(event) {
            playPauseButton.disabled = false;
            playPauseButton.textContent = '재생';
            playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
            
            playPauseButton.addEventListener('click', togglePlayPause);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                playPauseButton.textContent = '일시정지';
                playPauseButton.setAttribute('aria-label', '교리 오디오 일시정지');
                progressInterval = setInterval(updateProgressBar, 1000);
            } else {
                playPauseButton.textContent = '재생';
                playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
                clearInterval(progressInterval);
                if (event.data === YT.PlayerState.ENDED) {
                    progressBar.style.width = '100%';
                }
            }
        }

        function togglePlayPause() {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function updateProgressBar() {
            if (player && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
    </script>

</body>
</html>
