<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11월 1일 | 진노와 저주를 피하기 위해 하나님이 요구하시는 것</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl px-4 py-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">11월 1일</h1>
            <p class="text-xl text-gray-600 mt-2">진노와 저주를 피하기 위해 하나님이 요구하시는 것</p>
        </header>

        <section id="audio-player-section" class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4">AI요약 듣기</h2>
            <div id="player-ui" class="flex items-center space-x-4">
                <button id="play-pause-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full w-28 transition-opacity duration-300" aria-label="교리 오디오 재생/일시정지" disabled>
                    로딩 중...
                </button>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="player" class="hidden"></div>
            <div id="error-message" class="hidden text-red-500 mt-4"></div>
            <p class="mt-4 text-sm text-gray-500">
                오늘의 자료는 유튜브 영상입니다. '재생' 버튼을 누르면 영상의 음성이 재생됩니다.<br>
                영상 URL: <a href="https://www.youtube.com/watch?v=umKPKOg5HS8" target="_blank" class="text-blue-600 hover:underline">https://www.youtube.com/watch?v=umKPKOg5HS8</a>
            </p>
        </section>
        
        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">소요리문답 85문 / 대요리문답 153문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> (영상의 주제) 우리가 죄 때문에 마땅히 받아야 할 하나님의 진노와 저주를 피하기 위해 하나님께서 우리에게 요구하시는 것은 무엇입니까?</p>
                <p><strong class="font-bold">답:</strong> (영상의 요약) 하나님을 향한 진정한 회개와 우리 주 예수 그리스도를 향한 믿음, 그리고 그리스도께서 구원의 은혜를 전하시는 외적 수단들을 부지런히 사용하는 것입니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">교리 해설</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>
                    모든 사람은 아담의 불순종 이후 죄의 본성을 가지고 태어나며, 이로 인해 하나님의 공의로운 심판 아래 놓여 있습니다. 이는 <strong class="text-blue-600">‘전적 부패’</strong>의 상태로, 스스로는 영적인 선을 행할 능력이 전혀 없는 영적 무능력 상태를 의미합니다.
                </p>
                <p>
                    이러한 절망적인 상태에서 벗어나 하나님의 진노와 저주를 피하기 위해 하나님께서 요구하시는 핵심 사항은 세 가지로 요약할 수 있습니다.
                </p>
                <ul class="list-disc list-inside space-y-4 pl-4">
                    <li>
                        <strong class="text-blue-600">첫째, 하나님을 향한 회개입니다.</strong>
                        이는 단순히 벌받는 것이 두려워서 하는 후회와 다릅니다. 진정한 <strong class="text-blue-600">회개</strong>는 자신의 죄가 하나님의 거룩하심과 의로운 법에 얼마나 어긋나는지를 깨닫고 진심으로 슬퍼하는 데서 시작합니다. 그리고 여기서 멈추는 것이 아니라, 그리스도를 통해 보여주신 하나님의 자비를 의지하여 죄로부터 완전히 돌이켜 하나님의 뜻대로 살기로 결단하고 힘쓰는 것까지 포함합니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">둘째, 우리 주 예수 그리스도를 향한 믿음입니다.</strong>
                        이 <strong class="text-blue-600">믿음</strong> 역시 스스로 만들어내는 것이 아니라, 성령께서 말씀을 통해 우리 마음속에 일으켜 주시는 '구원의 은혜'입니다. 자신의 비참함과 스스로 구원할 수 없음을 깨닫고, 오직 성경이 말하는 예수 그리스도와 그분의 의로움만이 유일한 구원의 길임을 받아들이고 전적으로 의지하는 것입니다. 이 믿음을 통해서만 죄 용서를 받고 하나님과 화평을 누리게 됩니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">셋째, 외적 수단들을 부지런히 사용하는 것입니다.</strong>
                        여기서 <strong class="text-blue-600">‘외적 수단’</strong>이란 구체적으로 <strong class="text-blue-600">말씀</strong>(읽고 듣는 것), <strong class="text-blue-600">성례</strong>(세례와 성찬), 그리고 <strong class="text-blue-600">기도</strong>를 의미합니다. 구원의 은혜가 이 통로들을 통해 전달됩니다. '부지런히 사용하라'는 것은 횟수나 형식을 강조하는 행위 구원이 아닙니다. 오히려 믿음과 진실한 마음이 빠진 형식적인 참여는 아무 의미가 없음을 강조하는 것입니다. 은혜를 간절히 사모하는 마음과 믿음을 가지고 이 통로들에 능동적으로 참여해야만 하나님이 약속하신 유익을 얻게 됩니다.
                    </li>
                </ul>
                <p>
                    이 세 가지(회개, 믿음, 은혜의 수단 활용)는 서로 분리될 수 없으며 유기적으로 연결되어 있습니다. 회개는 믿음을 전제로 하며, 믿음은 은혜의 수단들을 통해 자라나고, 이 모든 과정 속에서 회개는 더욱 깊어집니다.
                </p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">적용 질문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>당신의 삶에서 이 외적 수단들, 그러니까 말씀과 성례와 기도를 '부지런히 사용한다'는 건 구체적으로 어떤 모습일까요? 혹시 그냥 습관적으로, 형식적으로 하고 있지는 않으신가요? 매일의 삶 속에서 정말 진실한 마음과 믿음으로 이 은혜의 통로들을 통해서 하나님을 만나고 그분의 은혜를 구하고 계신지 한번 깊이 돌아보는 시간을 가져보시는 건 어떨까 제안해 봅니다.</p>
            </div>
        </section>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        let player;
        let progressInterval;
        const playPauseButton = document.getElementById('play-pause-button');
        const progressBar = document.getElementById('progress-bar');
        const errorMessageDiv = document.getElementById('error-message');
        const playerUi = document.getElementById('player-ui');
        
        // 11월 1일 자료는 dcaddr.txt 파일이 아닌, 제공된 유튜브 링크를 직접 사용합니다.
        const videoIdForToday = 'umKPKOg5HS8';

        function onYouTubeIframeAPIReady() {
            // txt 파일 로드 대신 직접 ID로 플레이어 생성
            try {
                if (!videoIdForToday) {
                    throw new Error('No video ID specified.');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoIdForToday,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                console.error('Error creating player:', error);
            }
        }

        // 'dcaddr.txt' 파일을 로드하는 함수 (이 페이지에서는 사용되지 않음)
        // 이전에 디버깅한 가장 강력한 버전의 함수를 남겨둡니다.
        async function loadVideoForToday_fromFile() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('Audio address file could not be loaded.');
                }
                const data = await response.text();
                const lines = data.split('\n');
                
                const todayKey = '1101'; // 키는 1101로 설정

                // '1101'로 시작하는 줄을 찾습니다 (공백이나 '=' 모두 처리).
                const todayLine = lines.find(line => line.trim().startsWith(todayKey));
                
                if (!todayLine) {
                    throw new Error('not_uploaded');
                }

                // 날짜(키) 부분을 제외하고 나머지(URL)를 추출합니다.
                let url = todayLine.substring(todayKey.length).trim();
                // 맨 앞에 '=' 문자가 있다면 제거합니다.
                if (url.startsWith('=')) {
                    url = url.substring(1).trim();
                }

                const videoId = extractVideoID(url);

                if (!videoId) {
                    throw new Error('Invalid YouTube URL in dcaddr.txt');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                if (error.message === 'not_uploaded') {
                    errorMessageDiv.textContent = '오늘의 AI요약 음성은 아직 업로드 전입니다.';
                } else {
                    errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                    console.error('Error loading video:', error);
                }
            }
        }

        function extractVideoID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regArgsExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function onPlayerReady(event) {
            playPauseButton.disabled = false;
            playPauseButton.textContent = '재생';
            playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
            
            playPauseButton.addEventListener('click', togglePlayPause);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                playPauseButton.textContent = '일시정지';
                playPauseButton.setAttribute('aria-label', '교리 오디오 일시정지');
                progressInterval = setInterval(updateProgressBar, 1000);
            } else {
                playPauseButton.textContent = '재생';
                playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
                clearInterval(progressInterval);
                if (event.data === YT.PlayerState.ENDED) {
                    progressBar.style.width = '100%';
                }
            }
        }

        function togglePlayPause() {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function updateProgressBar() {
            if (player && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
    </script>

</body>
</html>
