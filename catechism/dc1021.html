<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10월 21일 | 보이는 교회의 특권</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl px-4 py-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">10월 21일</h1>
            <p class="text-xl text-gray-600 mt-2">보이는 교회의 특권</p>
        </header>

        <section id="audio-player-section" class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4">AI요약 듣기</h2>
            <div id="player-ui" class="flex items-center space-x-4">
                <button id="play-pause-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full w-28 transition-opacity duration-300" aria-label="교리 오디오 재생/일시정지" disabled>
                    로딩 중...
                </button>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="player" class="hidden"></div>
            <div id="error-message" class="hidden text-red-500 mt-4"></div>
        </section>
        
        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">대요리문답 63</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> 보이는 교회의 특권은 무엇입니까?</p>
                <p><strong class="font-bold">답:</strong> 보이는 교회의 특권은 하나님의 특별한 돌보심과 다스리심 아래 있음과, 모든 원수의 대적에도 불구하고 어느 시대나 보호받고 보존됨과, 성도의 교제와 구원의 일반적 수단들을 즐김과, 그리스도를 믿는 자는 누구나 구원받을 것임을 증언하고 그리스도에게로 나아오는 자는 누구도 내쫓지 않을 것이라는 복음의 사역을 통하여 보이는 교회의 모든 회원에게 권하시는 그리스도의 은혜를 누림입니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">교리 해설</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>
                    <strong class="text-blue-600">‘보이는 교회’</strong>의 회원은 “참된 신앙을 고백하는 자들과 이들의 자녀들”입니다. 그러나 외적인 신앙 고백이 내적인 진정성을 보증하지는 않으며, 신자의 자녀라는 신분이 곧 그들이 선택받은 자, 즉 <strong class="text-blue-600">‘보이지 않는 교회’</strong>의 구성원임을 보증하는 것도 아닙니다. 그렇다면 <strong class="text-blue-600">‘보이는 교회’</strong>의 회원이 되는 것이 왜 중요할까요? 대요리문답 63항은 그 중요성과 필요성을 다음의 다섯 가지 특권을 통해 교훈합니다.
                </p>
                <ul class="list-disc list-inside space-y-4 pl-4">
                    <li>
                        <strong class="text-blue-600">하나님의 특별한 돌보심과 다스리심 아래 있음:</strong> 하나님은 온 세상을 다스리시지만, 교회에 대해서는 특별한 목적을 가진 사랑으로 돌보시고 다스리십니다. 이 돌보심은 당신의 백성과 맺으신 <strong class="text-blue-600">언약</strong>을 신실하게 지키심으로 나타납니다. 중요한 것은 이 돌보심이 ‘다스림’을 통해 실현된다는 점입니다. 그리스도께서 분부하신 모든 것을 가르쳐 지키게 하는 명령에 순종하는 것이 곧 그분의 돌보심을 받는 길이며, 이 과정에는 사랑하는 자를 향한 징계와 채찍질도 포함됩니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">모든 원수의 대적에도 불구하고 보호받고 보존됨:</strong> 하나님께서는 환난 가운데서도 당신의 백성을 지키고 보존하십니다. 역사 속에서 특정 지역의 교회 공동체는 박해로 인해 사라지기도 했습니다. 소아시아의 일곱 교회처럼 유적만 남는 경우도 있습니다. 그러나 하나님께서는 다른 지역이나 다음 세대에 교회를 일으켜 세우심으로써, 보편적 교회로서의 <strong class="text-blue-600">‘보이는 교회’</strong>는 세상 끝날까지 결코 사라지지 않도록 보존하십니다. 주님께서는 “내 교회를 세우리니 음부의 권세가 이기지 못하리라”라고 약속하셨습니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">성도의 교제를 누림:</strong> 이 특권은 단순한 친목 모임이 아닌, 그리스도 안에서의 연합에 기초한 영적 교제입니다. 그리스도의 한 몸에 속한 지체로서 서로 교통하고 은사와 책임을 나누는 것은 유기적 연합체의 당연한 모습입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">구원의 일반적 수단들을 즐김:</strong> <strong class="text-blue-600">‘보이는 교회’</strong>는 합당한 예배와 복음 전파의 사명을 감당하기 위해 하나님께서 주신 말씀, 성례, 기도와 같은 일반적 은혜의 수단들을 가르치고 행할 특권을 가집니다. 이것은 의무인 동시에 큰 특권입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">그리스도의 은혜를 누림:</strong> 가장 중요한 특권은 <strong class="text-blue-600">‘보이는 교회’</strong> 안에서 복음이 모든 회원에게 공적으로, 차별 없이 제안된다는 사실입니다. 이 제안은 회개하고 믿으라는 부름이며, 믿는 자는 누구나 구원받고 주님께 오는 자는 결코 내쫓지 않으신다는 진실한 약속입니다. 이를 <strong class="text-blue-600">‘보편적 부름’</strong>이라 하는데, 이것은 외적인 부름입니다. 이 부름이 효과를 나타내기 위해서는 성령 하나님께서 내적으로 믿음을 일으키시는 <strong class="text-blue-600">‘효과 있는 부르심’</strong>이 필요하며, 이는 하나님의 택한 백성에게만 주어지는 은혜입니다.
                    </li>
                </ul>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">적용 질문</h2>
            <ol class="list-decimal list-inside space-y-4 text-lg leading-relaxed">
                <li>신앙고백서 대요리문답 63항에 따르면, '보이는 교회'가 누리는 첫 번째 특권인 "하나님의 특별한 돌보심과 다스리심"은 어떤 의미입니까? 우리는 하나님께서 교회를 다스리시고 돌보신다는 사실을 어떻게 인식하며, 그 다스림에 순종하는 삶을 살아야 하겠습니까?</li>
                <li>"모든 원수의 대적에도 불구하고 어느 시대나 보호받고 보존됨"이라는 특권은 어떻게 역사 속에서 교회가 사라지지 않고 계속 유지되어 온 사실을 설명합니까? 우리는 시대적 어려움과 위협 속에서도 교회의 존속과 보존을 약속하신 하나님의 신실하심을 어떻게 신뢰하며, 우리의 공동체를 지켜야 하겠습니까?</li>
                <li>'보이는 교회'의 특권 가운데 "성도의 교제"는 단순한 친분이 아니라 어떤 영적 의미를 가지며, 왜 그리스도의 한 몸으로서의 연합에 기초합니까? 우리는 성도의 교제를 단순한 모임 이상의 그리스도 안에서의 연합으로 여기며, 서로를 돌보는 책임을 어떻게 실천해야 하겠습니까?</li>
                <li>'보이는 교회'에서 모든 회원에게 주어지는 복음의 제안은 어떤 특징을 가지며, 왜 이것을 '보편적 부름'이라고 부릅니까? 우리는 모든 사람에게 복음을 제한 없이 제안하라는 교회의 사명을 어떻게 감당하며, 동시에 성령의 은혜 없이는 참된 믿음의 응답이 없음을 어떻게 겸손히 인정해야 하겠습니까?</li>
            </ol>
        </section>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        let player;
        let progressInterval;
        const playPauseButton = document.getElementById('play-pause-button');
        const progressBar = document.getElementById('progress-bar');
        const errorMessageDiv = document.getElementById('error-message');
        const playerUi = document.getElementById('player-ui');

        function onYouTubeIframeAPIReady() {
            loadVideoForToday();
        }

        async function loadVideoForToday() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('Audio address file could not be loaded.');
                }
                const data = await response.text();
                const lines = data.split('\n');
                
                const todayKey = '1021';

                // --- 수정된 부분 시작 ---
                // '1021'로 시작하는 줄을 찾습니다 (공백이나 '=' 모두 처리).
                const todayLine = lines.find(line => line.trim().startsWith(todayKey));
                
                if (!todayLine) {
                    throw new Error('not_uploaded');
                }

                // 날짜(키) 부분을 제외하고 나머지(URL)를 추출합니다.
                let url = todayLine.substring(todayKey.length).trim();
                // 맨 앞에 '=' 문자가 있다면 제거합니다.
                if (url.startsWith('=')) {
                    url = url.substring(1).trim();
                }
                // --- 수정된 부분 끝 ---

                const videoId = extractVideoID(url);

                if (!videoId) {
                    // URL은 찾았으나 비디오 ID 추출에 실패한 경우
                    throw new Error('Invalid YouTube URL in dcaddr.txt');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                if (error.message === 'not_uploaded') {
                    errorMessageDiv.textContent = '오늘의 AI요약 음성은 아직 업로드 전입니다.';
                } else {
                    errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                    console.error('Error loading video:', error);
                }
            }
        }

        function extractVideoID(url) {
            // 다양한 YouTube URL 형식에서 비디오 ID를 추출하는 정규식
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function onPlayerReady(event) {
            playPauseButton.disabled = false;
            playPauseButton.textContent = '재생';
            playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
            
            playPauseButton.addEventListener('click', togglePlayPause);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                playPauseButton.textContent = '일시정지';
                playPauseButton.setAttribute('aria-label', '교리 오디오 일시정지');
                progressInterval = setInterval(updateProgressBar, 1000);
            } else {
                playPauseButton.textContent = '재생';
                playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
                clearInterval(progressInterval);
                if (event.data === YT.PlayerState.ENDED) {
                    progressBar.style.width = '100%';
                }
            }
        }

        function togglePlayPause() {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function updateProgressBar() {
            if (player && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
    </script>

</body>
</html>
