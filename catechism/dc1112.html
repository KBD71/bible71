<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>날마다 읽는 교리 - 11월 12일</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" as="style" crossorigin="anonymous" />
    <style>
        body {
            font-family: "Pretendard", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            word-break: keep-all;
            background-color: #f3f4f6; /* Tailwind gray-100 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* lg */
            margin-bottom: 1.5rem; /* 6 */
            overflow: hidden;
        }
        .card-header {
            background-color: #4a5568; /* Tailwind gray-700 */
            color: white;
            padding: 1rem 1.5rem;
            font-size: 1.25rem; /* xl */
            font-weight: 700;
            border-bottom: 1px solid #e5e7eb; /* gray-200 */
        }
        .card-body {
            padding: 1.5rem;
            line-height: 1.75;
        }
        .card-body h3 {
            font-size: 1.125rem; /* lg */
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #1f2937; /* gray-800 */
        }
        .card-body p {
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body li {
            margin-bottom: 0.5rem;
        }
        .card-body .question {
            font-weight: 600;
            color: #111827; /* gray-900 */
        }
        .card-body .answer {
            color: #374151; /* gray-700 */
        }
        .audio-player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            background-color: #f9fafb; /* gray-50 */
            border-top: 1px solid #e5e7eb; /* gray-200 */
        }
        .audio-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
        }
        .audio-button:disabled {
            background-color: #e5e7eb; /* gray-200 */
            color: #9ca3af; /* gray-400 */
            cursor: not-allowed;
        }
        .audio-button.play {
            background-color: #2563eb; /* blue-600 */
            color: white;
        }
        .audio-button.play:hover {
            background-color: #1d4ed8; /* blue-700 */
        }
        .audio-button.pause {
            background-color: #f87171; /* red-400 */
            color: white;
        }
        .audio-button.pause:hover {
            background-color: #ef4444; /* red-500 */
        }
        .audio-error {
            color: #dc2626; /* red-600 */
            font-weight: 500;
            text-align: center;
        }
        #player-container {
            width: 1px;
            height: 1px;
            opacity: 0;
            position: absolute;
            top: -100px;
            left: -100px;
        }
        footer {
            text-align: center;
            padding: 2rem 1rem;
            font-size: 0.875rem; /* sm */
            color: #6b7280; /* gray-500 */
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto max-w-3xl px-4 py-8 sm:py-12">

        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-gray-800">11월 12일</h1>
            <p class="text-xl text-gray-600 mt-2">구원의 효과 있는 수단인 성례</p>
        </header>

        <main>
            <div class="card">
                <div class="card-header">
                    소요리문답 91문
                </div>
                <div class="card-body">
                    <div class="question-answer">
                        <p class="question">문91. 성례는 어떻게 구원의 효과 있는 수단이 됩니까?</p>
                        <p class="answer">답. 성례가 구원의 효과 있는 수단이 되는 것은 성례 자체나 성례를 시행하는 사람에게 어떤 능력이 있어서가 아니라, 오직 그리스도의 복 주심과 성례를 믿음으로 받는 자들 안에 계시는 성령 하나님의 역사하심 때문입니다.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    대요리문답 161문
                </div>
                <div class="card-body">
                    <div class="question-answer">
                        <p class="question">문161. 성례는 어떻게 구원의 효과 있는 수단이 됩니까?</p>
                        <p class="answer">답. 성례가 구원의 효과 있는 수단이 되는 것은 성례 자체에 어떤 능력이 있어서라든지, 혹은 성례를 시행하는 사람의 경건이나 의향에서 나오는 어떤 덕 때문이 아니고, 오직 성령 하나님의 역사하심과 성례를 제정하신 그리스도의 복 주심 때문입니다.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    교리 해설
                </div>
                <div class="card-body">
                    <p>오늘 읽는 소요리문답 91항과 대요리문답 161항은 성례가 실제로 구원의 은혜를 전달한다고 할 때 그 효력이 어디에서 오는지를 묻습니다. 두 문답의 대답은 동일하므로 대요리문답을 토대로 살펴봅니다.</p>

                    <h3>1. 성례는 "구원의 효과 있는 수단"이다</h3>
                    <p>성례는 구원이 이루어지는 일을 단지 상징하거나 기념하는 것이 아닙니다. 성례는 <strong class="text-blue-600">실제로 구원이 이루어지는 일에 사용되는 수단</strong>입니다. 대요리문답 153항에서 확인했듯이, 성례는 말씀, 기도와 더불어 그리스도의 중보의 유익을 우리에게 전달하는 '외적 수단' 중 하나입니다. 따라서 성례는 하나님의 진노와 저주를 피하고 구원을 얻기에 필요한 그리스도의 구속의 유익을 받는 방편입니다.</p>

                    <h3>2. 성례의 효력은 "성례 자체"에 있지 않다</h3>
                    <p>성례가 구원의 효과를 나타내는 것은 성례 자체에 어떤 능력이 있기 때문이 아닙니다. 이는 <strong class="text-blue-600">'사효성'(ex opere operato)</strong>, 즉 '행해진 행위 그 자체로부터' 효과가 주어진다는 로마 가톨릭의 주장을 배격하는 것입니다. 성례는 은혜의 방편이지만 "외적 수단"일 뿐, 그 자체나 그 행위 안에 구원의 능력을 지닌 것이 아닙니다. 성례의 유익은 오직 참여자가 <strong class="text-blue-600">은혜를 바라는 믿음으로 참여할 때</strong> 주어집니다. 형식적으로만 참여하는 것은 약속된 구원의 은혜를 전달하지 못합니다.</p>

                    <h3>3. 성례의 효력은 "시행하는 사람"에게 있지 않다</h3>
                    <p>성례의 효력은 성례를 시행하는 사람의 <strong class="text-blue-600">경건(piety)이나 의향(intention)</strong>에서 나오는 것도 아닙니다. 만일 그렇다면, 집례자가 성례의 효력을 발생시키는 능력을 행사하는 것이 됩니다. 집례자의 도덕적 상태나 영적 순결성, 혹은 그의 내면적 의도에 따라 성례의 효력이 결정되는 것이 아닙니다.</p>
                    <p>역사적으로 4세기 도나투스주의(Donatism)는 배교한 성직자가 집례한 성례는 무효라고 주장했습니다. 이에 대해 아우구스티누스는 <strong class="text-blue-600">성례의 거룩함은 집례자가 아니라 그리스도께 근거</strong>하며, 성례의 효력은 집례자의 개인적 상태에 달려 있지 않다고 바르게 가르쳤습니다.</p>

                    <h3>4. 성례의 효력은 "성령의 역사"와 "그리스도의 복 주심" 때문이다</h3>
                    <p>성례가 구원의 효과 있는 수단이 되는 근거는 오직 두 가지입니다. 바로 <strong class="text-blue-600">성령 하나님의 역사하심</strong>과 <strong class="text-blue-600">그리스도의 복 주심</strong>입니다.</p>
                    <ul>
                        <li>
                            <strong class="text-blue-600">성령 하나님의 역사</strong>: 성령께서는 성례가 표지하는 은혜가 참례자에게 실제로 적용되도록 역사하십니다. 신자의 마음을 비추어(조명) 성례의 표(물, 빵, 포도주)가 가리키는 은혜의 실체를 깨닫게 하십니다. 또한 믿음을 주시고 강화하여, 믿음으로 참여하는 신자를 그리스도와의 연합으로 이끌어 가십니다. 성령의 사역이 없다면 성례는 단순한 상징 행위에 그칠 것입니다.
                        </li>
                        <li>
                            <strong class="text-blue-600">그리스도의 복 주심</strong>: 성례의 제정자이신 그리스도께서는 교회의 머리이시며 언약의 중보자로서, 성례를 통해 약속하신 복(대속의 죽음, 부활, 영생 등)을 자신의 권위와 능력으로 실제로 전달하십니다.
                        </li>
                    </ul>
                    <p>따라서 신자들은 집례자의 상태와 관계없이, 오직 성령의 역사와 그리스도의 복 주심에 의지하여 자신이 받은 성례의 효력을 의심할 필요가 없습니다.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    AI요약 듣기
                </div>
                <div class="audio-player-container" id="audio-player-ui">
                    <div id="player-container"></div>
                    <button id="audio-button" class="audio-button play" aria-label="교리 오디오 재생" disabled>
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2">
                            <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2" style="display: none;">
                            <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z" clip-rule="evenodd" />
                        </svg>
                        <span id="button-text">로딩 중...</span>
                    </button>
                    <div id="audio-error" class="audio-error mt-4" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    적용 질문
                </div>
                <div class="card-body">
                    <ul>
                        <li><span class="question">1. 성례가 실제로 구원의 은혜를 전달하는 수단이 된다고 할 때, 그 효력은 어디에서 비롯되는가? 성례 자체가 능력을 지닌 것이 아니라 그리스도의 은혜를 전달하는 외적 방편으로 사용된다는 사실을 여러분은 믿고 있는가? 성례를 받을 때 단순히 의식에 참여하는 행위로만 여기는 것이 아니라, 그리스도께서 이 수단을 통해 자신의 구속의 은혜를 실제로 전달하신다는 믿음으로 참여하고 있는가?</span></li>
                        <li><span class="question">2. 성례가 효력을 가지는 것은 예식 자체의 힘에서가 아니라 믿음을 통한 참여에서 비롯된다는 점을 여러분은 어떻게 이해하는가? 만약 성례가 외적으로만 참여하는 것으로 그친다면 아무런 유익이 없다는 이 교훈 앞에서, 여러분은 세례나 성찬에 참여할 때 마음과 믿음으로 하나님께 나아가고 있는가? 성례의 형식보다 내면의 믿음을 더 중시하며 참여하고 있는가?</span></li>
                        <li><span class="question">3. 성례의 효력이 집례자의 경건이나 의도에 달려 있지 않다는 대요리문답의 가르침을 여러분은 어떻게 이해하는가? 만일 집례자의 신앙이 온전하지 않다 하더라도 성례의 효력은 그리스도께 달려 있다는 이 진리를 여러분은 신뢰하는가? 여러분은 사람을 의식하기보다, 그리스도께서 친히 집례하시며 복 주시는 분이심을 기억하고 성례에 참여하고 있는가?</span></li>
                        <li><span class="question">4. 성례가 구원의 효과 있는 수단이 되는 것은 오직 성령의 역사와 그리스도의 복 주심 때문이라는 사실을 여러분은 어떻게 깨닫고 있는가? 성령께서 신자의 마음을 밝히시고 믿음을 강화하여 그리스도와 연합하게 하신다는 이 교훈을 여러분의 신앙생활 속에서 어떻게 경험하고 있는가? 성례에 참여할 때 성령의 실제적 역사를 사모하며, 그리스도께서 약속하신 복을 믿음으로 붙잡고 있는가?</span></li>
                    </ul>
                </div>
            </div>
        </main>

        <footer>
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        let player;
        let videoId = null;
        let isPlayerReady = false;
        let isPlaying = false;
        const audioButton = document.getElementById('audio-button');
        const buttonText = document.getElementById('button-text');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const errorContainer = document.getElementById('audio-error');
        const playerUi = document.getElementById('audio-player-ui');

        // 1. YouTube API 로드
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // 2. API 콜백 함수
        function onYouTubeIframeAPIReady() {
            fetchAudioAddress();
        }

        // 3. 오디오 주소 fetch 및 파싱
        async function fetchAudioAddress() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('오디오 목록 파일을 불러오는 데 실패했습니다.');
                }
                const text = await response.text();
                const lines = text.split('\n');
                const today = getFormattedDate();
                const todayLine = lines.find(line => line.startsWith(today));

                if (todayLine) {
                    // 비디오 ID 추출 (URL 전체에서 ID만 정확히 파싱)
                    // 정규식: (v=... 또는 youtu.be/...) 다음에 오는 비디오 ID (특수문자 포함)
                    const regex = /(?:v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
                    const match = todayLine.match(regex);
                    if (match && match[1]) {
                        videoId = match[1];
                        initializePlayer();
                    } else {
                        throw new Error('오늘 날짜의 오디오 주소 형식이 올바르지 않습니다.');
                    }
                } else {
                    // 오늘 날짜의 주소가 없는 경우
                    showError('오늘의 AI요약 음성은 아직 업로드 전입니다.');
                }
            } catch (error) {
                console.error('Error fetching audio address:', error);
                showError(error.message || '오디오를 불러오는 중 오류가 발생했습니다.');
            }
        }

        // 4. 오늘 날짜 포맷 (MMDD)
        function getFormattedDate() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            // return `${month}${day}`;
            return '1112'; // 요청된 날짜로 고정
        }

        // 5. 플레이어 초기화
        function initializePlayer() {
            player = new YT.Player('player-container', {
                height: '1',
                width: '1',
                videoId: videoId,
                playerVars: {
                    'playsinline': 1,
                    'controls': 0,
                    'showinfo': 0,
                    'rel': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 6. 플레이어 준비 완료
        function onPlayerReady(event) {
            isPlayerReady = true;
            audioButton.disabled = false;
            buttonText.textContent = 'AI요약 듣기';
            audioButton.setAttribute('aria-label', '교리 오디오 재생');
            audioButton.addEventListener('click', togglePlayPause);
        }

        // 7. 플레이어 상태 변경
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updateButtonUI(true);
            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                updateButtonUI(false);
                if (event.data === YT.PlayerState.ENDED) {
                    player.seekTo(0); // 끝나면 처음으로 되감기
                }
            }
        }

        // 8. 재생/일시정지 토글
        function togglePlayPause() {
            if (!isPlayerReady) return;
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        // 9. 버튼 UI 업데이트
        function updateButtonUI(playing) {
            if (playing) {
                audioButton.classList.remove('play');
                audioButton.classList.add('pause');
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'inline';
                buttonText.textContent = '일시정지';
                audioButton.setAttribute('aria-label', '교리 오디오 일시정지');
            } else {
                audioButton.classList.remove('pause');
                audioButton.classList.add('play');
                playIcon.style.display = 'inline';
                pauseIcon.style.display = 'none';
                buttonText.textContent = 'AI요약 듣기';
                audioButton.setAttribute('aria-label', '교리 오디오 재생');
            }
        }

        // 10. 오류 처리
        function showError(message) {
            // 기존 UI 숨기기
            const button = document.getElementById('audio-button');
            if (button) {
                button.style.display = 'none';
            }
            
            // 오류 메시지 표시
            errorContainer.textContent = message;
            errorContainer.style.display = 'block';
        }

        // API 로드 시작
        loadYouTubeAPI();
    </script>

</body>
</html>
