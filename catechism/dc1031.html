<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10월 31일 | 신자가 죽을 때 그리스도로부터 받는 은택</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl px-4 py-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">10월 31일</h1>
            <p class="text-xl text-gray-600 mt-2">신자가 죽을 때 그리스도로부터 받는 은택</p>
        </header>

        <section id="audio-player-section" class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4">AI요약 듣기</h2>
            <div id="player-ui" class="flex items-center space-x-4">
                <button id="play-pause-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full w-28 transition-opacity duration-300" aria-label="교리 오디오 재생/일시정지" disabled>
                    로딩 중...
                </button>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="player" class="hidden"></div>
            <div id="error-message" class="hidden text-red-500 mt-4"></div>
        </section>
        
        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">소요리문답 37</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> 신자는 죽음에서 그리스도로부터 어떤 은택을 받습니까?</p>
                <p><strong class="font-bold">답:</strong> 신자의 영혼은 죽을 때 완전히 거룩하게 되고, 즉시 영광에 들어갑니다. 그리고 몸은 여전히 그리스도와 연합되어 있고 부활할 때까지 무덤 속에서 편히 쉽니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">대요리문답 86</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> 보이지 않는 교회의 지체들이 죽은 직후에 누리는 그리스도와 함께하는 영광의 교제는 무엇입니까?</p>
                <p><strong class="font-bold">답:</strong> 보이지 않는 교회의 지체들이 죽은 직후에 누리는 그리스도와 함께하는 영광의 교제는 이들의 영혼이 그때 완전히 거룩하게 되어, 지극히 높은 하늘에 영접받아 들어가고, 거기서 빛과 영광 중에 하나님의 얼굴을 뵈며 몸의 완전한 구속을 기다리는 것입니다. 이들의 몸은 죽음의 상태에서도 그리스도와 계속 연합되어 있으며, 마지막 날에 자신들의 영혼과 다시 연합할 때까지 마치 잠자리에 있듯이 무덤 속에서 편히 쉬고 있습니다. 그러나 악인들의 영혼은 죽을 때 지옥에 던져지고, 거기서 고통과 깊은 흑암 중에 머물러 있으며, 이들의 몸은 부활과 심판의 큰 날까지 마치 감옥에 있듯이 무덤 속에 갇혀 있습니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">교리 해설</h2>
            <div class="space-y-6 text-lg leading-relaxed">
                <p>
                    신자가 죽음을 맞이할 때, 그리스도와의 영광스러운 교제는 중단되는 것이 아니라 새로운 차원으로 들어갑니다. 대요리문답 86항은 신자의 영혼과 몸, 그리고 대조적으로 악인의 영혼과 몸이 죽음 이후에 어떤 상태에 놓이는지를 다섯 가지로 설명합니다.
                </p>
                
                <ol class="list-decimal list-inside space-y-4">
                    <li>
                        <strong class="text-blue-600">영혼의 즉각적이고 완전한 성화:</strong>
                        신자가 죽는 순간, 이 땅에서 계속되던 죄와의 싸움은 완전히 끝납니다. 점진적으로 이루어지던 <strong class="text-blue-600">성화</strong>가 단번에 완성되어, 영혼은 완전히 거룩한 상태로 "온전하게 된 의인의 영들"(히 12:23)이 있는 곳으로 들어갑니다. 이는 성화를 소망해 온 신자에게 최고의 기쁨과 승리입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">하늘에 영접받음:</strong>
                        완전히 거룩해진 영혼은 즉시 "지극히 높은 하늘"에 영접받습니다. 이 땅의 죄와 허물로 인해 거절당할까 두려워할 필요가 없습니다. 그리스도께서 "너희를 내게로 영접하여 나 있는 곳에 너희도 있게 하리라"(요 14:3)고 약속하셨기 때문입니다. 과거의 죄에 대한 기억은 정죄의 근거가 아니라, 용서하신 하나님의 은혜를 찬송하는 증거가 될 뿐입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">하나님의 얼굴을 뵘:</strong>
                        하늘에서 성도의 영혼은 "빛과 영광 중에 하나님의 얼굴을 뵙는" 최고의 영광을 누립니다. 이것은 육신의 눈으로 보는 것이 아니라, 하나님의 임재의 영광을 충만하게 경험하며 그분에 대한 지식이 완전해지는 것을 의미합니다. 이 땅에서는 거울로 보는 것처럼 희미하지만(고전 13:12), 그때에는 하나님을 온전히 알게 되는 완전한 교제가 이루어집니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">몸의 안식과 부활의 소망:</strong>
                        영혼이 하늘에서 영광을 누리는 동안, 신자의 몸은 무덤 속에서 <strong class="text-blue-600">마치 잠자리에 있듯이 편히 쉽니다</strong>. 몸은 죽음 아래에서도 여전히 그리스도와 연합되어 있으며(롬 8:38-39), 이 연합은 결코 끊어지지 않습니다. 하나님께서는 그 몸을 기억하고 보존하셨다가, 마지막 날 영광스러운 몸으로 부활시켜 영혼과 다시 연합하게 하십니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">악인의 상태와 대조:</strong>
                        반면, 악인의 영혼은 죽는 즉시 지옥에 던져져 고통과 흑암 중에 머뭅니다. 그들의 몸은 <strong class="text-blue-600">마치 감옥에 있듯이 무덤 속에 갇혀</strong> 있다가, 마지막 심판의 날에 부활하여 영원한 형벌을 받게 됩니다. 신자에게 무덤이 안식의 잠자리라면, 악인에게 무덤은 심판을 기다리는 감옥입니다.
                    </li>
                </ol>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">적용 질문</h2>
            <ol class="list-decimal list-inside space-y-4 text-lg leading-relaxed">
                <li>대요리문답 86항은 신자의 죽음 직후 영혼이 어떤 은혜를 누린다고 가르치며, 이것이 성화와 어떤 관련이 있습니까? 우리는 죽음이 성화를 완성하는 순간임을 기억하며, 지금의 성화의 싸움 가운데 끝까지 소망을 품고 인내하며 살아가고 있습니까?</li>
                <li>성도의 영혼이 "지극히 높은 하늘에 영접 받아 들어간다"라는 표현은 어떤 의미이며, 왜 성도는 두려움 없이 이 영접을 확신할 수 있습니까? 우리는 그리스도의 약속을 붙잡고, 죽음을 두려움의 순간이 아니라 주님께 영접받는 확신의 순간으로 바라보며 살고 있습니까?</li>
                <li>성도가 "빛과 영광 중에 하나님의 얼굴을 뵌다"라는 말은 어떤 의미이며, 문자적 시각 경험이 아닌 실제의 뜻은 무엇입니까? 우리는 장차 하나님의 임재를 충만히 누리며 그분을 알게 될 소망을 품고, 지금 이 땅에서는 말씀과 성령 안에서 부분적이나마 하나님을 깊이 알아가고 있습니까?</li>
                <li>대요리문답 86항은 성도의 몸과 악인의 몸이 죽음 이후 각각 어떤 상태에 놓인다고 설명하며, 무덤은 각기 어떤 의미로 비유됩니까? 우리는 무덤이 성도에게는 안식의 잠자리이지만 악인에게는 감옥이라는 사실을 기억하며, 오늘을 부활과 심판을 준비하는 날로 삼아 살아가고 있습니까?</li>
            </ol>
        </section>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        let player;
        let progressInterval;
        const playPauseButton = document.getElementById('play-pause-button');
        const progressBar = document.getElementById('progress-bar');
        const errorMessageDiv = document.getElementById('error-message');
        const playerUi = document.getElementById('player-ui');

        function onYouTubeIframeAPIReady() {
            loadVideoForToday();
        }

        async function loadVideoForToday() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('Audio address file could not be loaded.');
                }
                const data = await response.text();
                const lines = data.split('\n');
                
                const todayKey = '1031';

                // --- 수정된 부분 시작 ---
                // '1021'로 시작하는 줄을 찾습니다 (공백이나 '=' 모두 처리).
                const todayLine = lines.find(line => line.trim().startsWith(todayKey));
                
                if (!todayLine) {
                    throw new Error('not_uploaded');
                }

                // 날짜(키) 부분을 제외하고 나머지(URL)를 추출합니다.
                let url = todayLine.substring(todayKey.length).trim();
                // 맨 앞에 '=' 문자가 있다면 제거합니다.
                if (url.startsWith('=')) {
                    url = url.substring(1).trim();
                }
                // --- 수정된 부분 끝 ---

                const videoId = extractVideoID(url);

                if (!videoId) {
                    // URL은 찾았으나 비디오 ID 추출에 실패한 경우
                    throw new Error('Invalid YouTube URL in dcaddr.txt');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                if (error.message === 'not_uploaded') {
                    errorMessageDiv.textContent = '오늘의 AI요약 음성은 아직 업로드 전입니다.';
                } else {
                    errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                    console.error('Error loading video:', error);
                }
            }
        }

        function extractVideoID(url) {
            // 다양한 YouTube URL 형식에서 비디오 ID를 추출하는 정규식
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function onPlayerReady(event) {
            playPauseButton.disabled = false;
            playPauseButton.textContent = '재생';
            playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
            
            playPauseButton.addEventListener('click', togglePlayPause);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                playPauseButton.textContent = '일시정지';
                playPauseButton.setAttribute('aria-label', '교리 오디오 일시정지');
                progressInterval = setInterval(updateProgressBar, 1000);
            } else {
                playPauseButton.textContent = '재생';
                playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
                clearInterval(progressInterval);
                if (event.data === YT.PlayerState.ENDED) {
                    progressBar.style.width = '100%';
                }
            }
        }

        function togglePlayPause() {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function updateProgressBar() {
            if (player && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
    </script>

</body>
</html>
