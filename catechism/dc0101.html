<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1월 1일 - 날마다 읽는 교리</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body {
            font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 antialiased">

    <div class="max-w-3xl mx-auto min-h-screen flex flex-col shadow-lg bg-white">
        <header class="bg-blue-900 text-white p-6 text-center rounded-t-lg">
            <h1 class="text-3xl font-extrabold tracking-tight mb-2">날마다 읽는 교리</h1>
            <p class="text-blue-200 text-lg font-medium">1월 1일</p>
        </header>

        <main class="flex-grow p-6 space-y-8">
            
            <section class="bg-blue-50 rounded-xl p-6 border border-blue-100 shadow-sm">
                <h2 class="text-xl font-bold text-blue-900 mb-4 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path></svg>
                    AI요약 듣기
                </h2>
                <div id="audio-player-container" class="flex flex-col items-center justify-center">
                    <div id="youtube-player" class="hidden"></div>
                    <div class="flex items-center space-x-4 w-full justify-center">
                        <button id="play-button" disabled class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2" aria-label="교리 오디오 재생">
                            <span id="btn-text">로딩 중...</span>
                        </button>
                    </div>
                    <p id="player-status" class="mt-3 text-sm text-gray-500 h-5"></p>
                    <div id="error-message" class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm text-center w-full"></div>
                </div>
            </section>

            <section>
                <h2 class="text-2xl font-bold text-gray-900 border-b-2 border-gray-200 pb-2 mb-4">말씀 요절</h2>
                <div class="bg-gray-50 p-5 rounded-lg border-l-4 border-gray-600 italic text-gray-700 leading-relaxed">
                    "주의 교훈으로 나를 인도하시고 후에는 영광으로 나를 영접하시리니 하늘에서는 주 외에 누가 내게 있으리요 땅에서는 주 밖에 내가 사모할 이 없나이다 내 육체와 마음은 쇠약하나 하나님은 내 마음의 반석이시요 영원한 분깃이시라 무릇 주를 멀리하는 자는 망하리니 음녀 같이 주를 떠난 자를 주께서 다 멸하셨나이다 하나님께 가까이 함이 내게 복이라 내가 주 여호와를 나의 피난처로 삼아 주의 모든 행적을 전파하리이다"
                    <br><span class="block text-right font-bold mt-2 not-italic text-sm">- 시편 73:24-28</span>
                </div>
            </section>

            <section class="space-y-6">
                <h2 class="text-2xl font-bold text-gray-900 border-b-2 border-gray-200 pb-2 mb-4">신앙고백서와 요리문답</h2>
                
                <div class="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden">
                    <div class="bg-gray-100 px-5 py-3 border-b border-gray-200 font-bold text-gray-800 flex justify-between items-center">
                        <span>소요리문답 1</span>
                    </div>
                    <div class="p-5">
                        <p class="font-bold text-lg mb-2 text-blue-800">문1. 사람에게 주어진 첫째가는 목적은 무엇입니까?</p>
                        <p class="text-gray-700 leading-relaxed">답. 사람에게 주어진 첫째가는 목적은 영원토록 하나님을 영화롭게 함과 즐거워함입니다.</p>
                    </div>
                </div>

                <div class="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden">
                    <div class="bg-gray-100 px-5 py-3 border-b border-gray-200 font-bold text-gray-800 flex justify-between items-center">
                        <span>대요리문답 1</span>
                    </div>
                    <div class="p-5">
                        <p class="font-bold text-lg mb-2 text-blue-800">문1. 사람에게 주어진 첫째가며 가장 높은 목적은 무엇입니까?</p>
                        <p class="text-gray-700 leading-relaxed">답. 사람에게 주어진 첫째가며 가장 높은 목적은 영원토록 하나님을 영화롭게 함과 온전히 즐거워함입니다.</p>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="text-2xl font-bold text-gray-900 border-b-2 border-gray-200 pb-2 mb-4">교리 해설</h2>
                <div class="prose prose-lg text-gray-700 leading-relaxed space-y-4">
                    <p>
                        사람의 생명은 스스로 존재하는 것이 아닙니다. 그것은 <strong class="text-blue-700">창조주 하나님</strong>께서 주신 선물입니다. 따라서 피조물인 사람이 누릴 수 있는 가장 복된 삶은, 스스로 정한 길이 아니라 창조주 하나님께서 부여하신 목적을 따라 살아가는 데 있습니다. 그 목적은 바로 <strong>하나님을 영화롭게 하고 하나님을 온전히 즐거워하는 일</strong>입니다.
                    </p>
                    <p>
                        이 목적은 사람이 자신의 필요에 따라 임의로 정한 것이 아닙니다. 창조주 하나님께서 직접 우리에게 부여하신 것입니다. 중요한 점은, 하나님께서 무엇인가 부족하여 사람의 영광과 기쁨을 필요로 하시는 것이 아니라는 사실입니다. 하나님께서는 스스로 완전한 영광 중에 계시며, 충만한 기쁨 가운데 거하십니다. 그럼에도 불구하고 이 목적을 우리에게 두신 이유는 오직 <strong class="text-blue-700">하나님의 사랑</strong> 때문입니다. 하나님을 영화롭게 하고 그분을 즐거워하는 것이야말로 피조물인 사람에게 <strong>가장 큰 복</strong>이 되기 때문입니다.
                    </p>
                    <p>
                        그렇다면 구체적으로 하나님을 영화롭게 한다는 것은 무엇일까요?
                    </p>
                    <ul class="list-disc pl-5 space-y-2 bg-gray-50 p-4 rounded-lg">
                        <li>창조주 하나님의 <strong>지혜와 권능의 영광</strong>을 찬양하는 것입니다.</li>
                        <li>선택한 백성을 향한 <strong>하나님의 긍휼</strong>과, 악인을 향한 <strong>하나님의 공의</strong>를 높이는 것입니다.</li>
                        <li>오직 하나님만을 사모하며 그분께 가까이 나아가기를 즐거워하는 것입니다.</li>
                    </ul>
                    <p>
                        또한, 하나님께서 행하신 모든 일과 교훈의 말씀을 고백하고 전파하는 삶이 뒤따라야 합니다. 일상생활 속에서 경험하는 <strong class="text-blue-700">하나님의 섭리</strong>에 감사하고, 특별히 공적 예배 가운데 하나님의 은혜를 높이며 구원을 즐거워하는 일이야말로 인생의 가장 큰 목적이자 사명이며, 동시에 우리가 살아가는 이유입니다.
                    </p>
                </div>
            </section>



        </main>

        <footer class="bg-gray-800 text-gray-300 py-6 text-center text-sm">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>
    </div>

    <script>
        // 현재 날짜 설정 (MMDD 형식)
        const currentDate = '0101'; 

        // YouTube IFrame API 로드
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;
        var isPlaying = false;
        var videoId = "";

        // API 준비 시 호출
        function onYouTubeIframeAPIReady() {
            fetchAudioAddress();
        }

        // 주소 파일 fetch 및 파싱 로직
        async function fetchAudioAddress() {
            const playButton = document.getElementById('play-button');
            const btnText = document.getElementById('btn-text');
            const errorMessage = document.getElementById('error-message');

            try {
                // ../address/dcaddr.txt 경로에서 파일 읽기
                const response = await fetch('../address/dcaddr.txt');
                
                if (!response.ok) {
                    throw new Error('주소 파일을 불러오는데 실패했습니다.');
                }

                const text = await response.text();
                const lines = text.split('\n');
                let foundUrl = null;

                // 오늘 날짜로 시작하는 줄 찾기
                for (let line of lines) {
                    if (line.trim().startsWith(currentDate)) {
                        const parts = line.split(' ');
                        if (parts.length >= 2) {
                            foundUrl = parts[1].trim();
                            break;
                        }
                    }
                }

                if (foundUrl) {
                    // YouTube URL에서 Video ID 추출 (정규식)
                    const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
                    const match = foundUrl.match(regExp);
                    
                    if (match && match[7].length == 11) {
                        videoId = match[7];
                        initializePlayer(videoId);
                    } else {
                        throw new Error('유효하지 않은 YouTube URL입니다.');
                    }
                } else {
                    // 날짜에 해당하는 주소가 없을 때
                    playButton.classList.add('hidden');
                    errorMessage.textContent = "오늘의 AI요약 음성은 아직 업로드 전입니다.";
                    errorMessage.classList.remove('hidden');
                }

            } catch (error) {
                console.error('Error:', error);
                playButton.classList.add('hidden');
                errorMessage.textContent = "오디오 정보를 불러오는 중 오류가 발생했습니다.";
                errorMessage.classList.remove('hidden');
            }
        }

        // 플레이어 초기화
        function initializePlayer(id) {
            const playButton = document.getElementById('play-button');
            const btnText = document.getElementById('btn-text');

            player = new YT.Player('youtube-player', {
                height: '0',
                width: '0',
                videoId: id,
                playerVars: {
                    'playsinline': 1,
                    'controls': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            const playButton = document.getElementById('play-button');
            const btnText = document.getElementById('btn-text');
            
            playButton.disabled = false;
            btnText.textContent = '재생';
            
            playButton.addEventListener('click', togglePlay);
        }

        function onPlayerStateChange(event) {
            const btnText = document.getElementById('btn-text');
            const playButton = document.getElementById('play-button');
            const statusText = document.getElementById('player-status');

            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                btnText.textContent = '일시정지';
                playButton.setAttribute('aria-label', '교리 오디오 일시정지');
                statusText.textContent = '재생 중...';
            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                btnText.textContent = '재생';
                playButton.setAttribute('aria-label', '교리 오디오 재생');
                if(event.data === YT.PlayerState.ENDED) {
                    statusText.textContent = '재생 완료';
                } else {
                    statusText.textContent = '일시정지됨';
                }
            }
        }

        function togglePlay() {
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }
    </script>
</body>
</html>
