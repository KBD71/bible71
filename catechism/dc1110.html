<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>날마다 읽는 교리 - 11월 10일</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" as="style" crossorigin="anonymous" />
    <style>
        body {
            font-family: "Pretendard", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            word-break: keep-all;
            background-color: #f3f4f6; /* Tailwind gray-100 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* lg */
            margin-bottom: 1.5rem; /* 6 */
            overflow: hidden;
        }
        .card-header {
            background-color: #4a5568; /* Tailwind gray-700 */
            color: white;
            padding: 1rem 1.5rem;
            font-size: 1.25rem; /* xl */
            font-weight: 700;
            border-bottom: 1px solid #e5e7eb; /* gray-200 */
        }
        .card-body {
            padding: 1.5rem;
            line-height: 1.75;
        }
        .card-body h3 {
            font-size: 1.125rem; /* lg */
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #1f2937; /* gray-800 */
        }
        .card-body p {
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body li {
            margin-bottom: 0.5rem;
        }
        .card-body .question {
            font-weight: 600;
            color: #111827; /* gray-900 */
        }
        .card-body .answer {
            color: #374151; /* gray-700 */
        }
        .audio-player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            background-color: #f9fafb; /* gray-50 */
            border-top: 1px solid #e5e7eb; /* gray-200 */
        }
        .audio-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
        }
        .audio-button:disabled {
            background-color: #e5e7eb; /* gray-200 */
            color: #9ca3af; /* gray-400 */
            cursor: not-allowed;
        }
        .audio-button.play {
            background-color: #2563eb; /* blue-600 */
            color: white;
        }
        .audio-button.play:hover {
            background-color: #1d4ed8; /* blue-700 */
        }
        .audio-button.pause {
            background-color: #f87171; /* red-400 */
            color: white;
        }
        .audio-button.pause:hover {
            background-color: #ef4444; /* red-500 */
        }
        .audio-error {
            color: #dc2626; /* red-600 */
            font-weight: 500;
            text-align: center;
        }
        #player-container {
            width: 1px;
            height: 1px;
            opacity: 0;
            position: absolute;
            top: -100px;
            left: -100px;
        }
        footer {
            text-align: center;
            padding: 2rem 1rem;
            font-size: 0.875rem; /* sm */
            color: #6b7280; /* gray-500 */
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto max-w-3xl px-4 py-8 sm:py-12">

        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-gray-800">11월 10일</h1>
            <p class="text-xl text-gray-600 mt-2">은혜언약의 거룩한 표지이며 인장인 성례</p>
        </header>

        <main>
            <div class="card">
                <div class="card-header">
                    신앙고백서 27.1
                </div>
                <div class="card-body">
                    <p class="answer">성례는 은혜언약의 거룩한 표지이고 인장이며, 하나님께서 직접 제정하신 것으로, 그리스도와 그분의 은택들을 나타내고, 그리스도 안에 있는 우리의 권리를 확증하며 또한 교회에 속한 사람들을 세상에 속한 사람들과 눈에 보이게 구별하고, 하나님의 말씀을 따라 그리스도 안에서 하나님을 섬기는 일에 엄숙히 참여하도록 하기 위한 것이다.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    교리 해설
                </div>
                <div class="card-body">
                    <p>오늘 읽는 웨스트민스터 신앙고백서 27.1은 어제 살핀 대요리문답 162항과 동일한 내용을 진술합니다. 어제는 성례가 하나님께서 제정하신 거룩한 규례이며, 그리스도의 은혜를 '표하고' '인치는' 표지라는 점을 살펴보았습니다. 오늘은 두 문서가 공통으로 말하는 나머지 세 가지 내용을 살펴보겠습니다.</p>

                    <h3>1. 우리의 권리를 확증하며 은혜를 강화함</h3>
                    <p>성례는 그리스도께서 제정하신 것으로, 그분의 구속의 은혜를 표하고, 인치며, 제시합니다. 이를 통해 신자는 <strong class="text-blue-600">믿음과 다른 모든 은혜들</strong>(회개, 인내, 사랑, 소망 등)이 더욱 강화되고 성장하는 은혜를 누립니다. 그래서 성례를 "은혜의 방편"이라고 부릅니다.</p>
                    <p>신앙고백서는 이 은혜를 "그리스도 안에 있는 <strong class="text-blue-600">우리의 권리(our interest)를 확증한다</strong>"고 진술합니다. 여기서 '우리의 권리'란 신자가 그리스도와의 연합으로 말미암아 누리게 되는 모든 합법적 권리와 은택을 가리킵니다. 예를 들어, <strong class="text-blue-600">의롭다 하심을 받은 의인의 신분, 하나님의 자녀로 입양된 양자의 신분</strong>, 그리고 성령의 도우심으로 이루어 가는 거룩한 변화 등이 이에 해당합니다. 성례는 바로 이러한 신분과 은혜가 더욱 강화되고 증진되도록 하는 은혜의 방편입니다.</p>

                    <h3>2. 교회에 속한 자와 세상을 구별함</h3>
                    <p>성례는 신자가 그리스도와 연합하며, 동시에 성도들과도 연합함을 드러내는 표지입니다. 세례는 믿음을 고백하고 교회 공동체의 일원으로 받아들여지는 성례이며, 성찬은 이미 교회에 속한 자들이 주님과의 연합과 교제를 가시적으로 드러내는 성례입니다.</p>
                    <p>이처럼 성례는 <strong class="text-blue-600">교회에 속한 사람들과 세상에 속한 사람들을 눈에 보이게 구별</strong>합니다. 이 구별은 성례가 교회의 공적 사역임을 전제합니다. 성례는 그리스도께서 교회를 세우시며 교회의 공적 사역으로 제정하신 규례이기에, 개인적이거나 사사로운 모임에서 행해질 수 없습니다. 성례는 반드시 교회의 세 가지 표지(말씀 선포, 성례 시행, 권징) 중 하나로서 교회의 공적 예배 속에서 집행될 때에만 유효합니다.</p>
                    <p>대요리문답은 이 구별을 <strong class="text-blue-600">"은혜언약 밖에 있는 자들과 구별"</strong>한다고 표현합니다. 신앙고백서가 '보이는 교회'의 제도적 측면에서 구별한다면, 대요리문답은 '은혜언약'이라는 구원론적 관점에서 구별합니다. 즉, 교회 회원 중에도 고백한 믿음이 진실하지 않은 '외적 참여자'가 있을 수 있습니다. 대요리문답은 성례의 실제 효력이 오직 은혜언약의 '내적 참여자', 곧 참된 믿음을 가진 자들에게만 적용된다는 사실을 강조합니다.</p>

                    <h3>3. 순종의 의무에 참여하게 함</h3>
                    <p>성례는 신자에게 구속의 은혜를 확증하는 '표'이자 언약의 약속을 보증하는 '인'입니다. 동시에 성례는 참여자에게 <strong class="text-blue-600">하나님과 맺은 언약 안에서의 순종의 의무</strong>를 일깨웁니다. 참여자는 베푸신 은혜에 감사하며 그분의 뜻에 순종하겠다는 헌신을 새롭게 서약합니다.</p>
                    <p>신앙고백서는 이를 "하나님을 섬기는 일에 엄숙히 참여하도록 한다"고 표현하며, 대요리문답은 "이들이 순종하게 하고"라고 직접적으로 밝힙니다. 이는 은혜언약의 핵심 원리, 즉 <strong class="text-blue-600">은혜로 구원받은 자는 은혜에 합당한 순종의 삶으로 부름받는다</strong>는 진리를 반영합니다. 세례는 우리가 새 생명 가운데서 행하도록 부름받았음을 보여주며(롬 6:4), 성찬은 그리스도의 뜻을 좇아 그분의 사랑과 희생을 본받는 삶을 살게 합니다.</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    AI요약 듣기
                </div>
                <div class="audio-player-container" id="audio-player-ui">
                    <div id="player-container"></div>
                    <button id="audio-button" class="audio-button play" aria-label="교리 오디오 재생" disabled>
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2">
                            <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2" style="display: none;">
                            <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z" clip-rule="evenodd" />
                        </svg>
                        <span id="button-text">로딩 중...</span>
                    </button>
                    <div id="audio-error" class="audio-error mt-4" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    적용 질문
                </div>
                <div class="card-body">
                    <ul>
                        <li><span class="question">1. 성례는 어떻게 신자에게 그리스도와의 연합으로 얻은 권리와 은택, 곧 의롭다 하심과 양자의 신분, 거룩하게 되는 은혜를 확증해 줍니까? 여러분은 성례를 받을 때, 하나님께서 실제로 여러분에게 그리스도 안의 신분과 권리를 확증하신다는 사실을 믿으며 그 은혜를 삶 속에서 드러내고 있습니까?</span></li>
                        <li><span class="question">2. 성례는 어떤 방식으로 교회에 속한 자들과 세상에 속한 자들을 눈에 보이게 구별합니까? 여러분은 교회의 공예배 안에서 성례에 참여할 자로 부름받았다는 사실을 귀히 여기며, 세상과 구별된 교회의 일원으로서 거룩과 순결의 삶을 살아가고 있습니까?</span></li>
                        <li><span class="question">3. 신앙고백서와 대요리문답은 왜 성례의 참여 범위를 각각 교회론적 기준과 은혜언약의 기준으로 달리 진술합니까? 여러분은 자신이 단지 교회의 외적인 회원으로 머물러 있는지, 아니면 참된 믿음으로 은혜언약의 내적 참여자가 되어 성령의 역사 안에 살고 있는지를 점검하며, 하나님의 은혜 앞에서 진실한 믿음을 새롭게 하고 있습니까?</span></li>
                        <li><span class="question">4. 성례는 왜 은혜언약 안에서 신자에게 순종의 삶을 요구하며, 하나님을 섬기고 그분의 뜻을 따르겠다는 헌신을 새롭게 서약하게 합니까? 여러분은 세례와 성찬을 통해 하나님께 대한 순종의 서약을 기억하며, 그리스도의 사랑과 희생을 본받아 순종과 섬김의 열매를 맺는 삶을 살고 있습니까?</span></li>
                    </ul>
                </div>
            </div>
        </main>

        <footer>
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        let player;
        let videoId = null;
        let isPlayerReady = false;
        let isPlaying = false;
        const audioButton = document.getElementById('audio-button');
        const buttonText = document.getElementById('button-text');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const errorContainer = document.getElementById('audio-error');
        const playerUi = document.getElementById('audio-player-ui');

        // 1. YouTube API 로드
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // 2. API 콜백 함수
        function onYouTubeIframeAPIReady() {
            fetchAudioAddress();
        }

        // 3. 오디오 주소 fetch 및 파싱
        async function fetchAudioAddress() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('오디오 목록 파일을 불러오는 데 실패했습니다.');
                }
                const text = await response.text();
                const lines = text.split('\n');
                const today = getFormattedDate();
                const todayLine = lines.find(line => line.startsWith(today));

                if (todayLine) {
                    // 비디오 ID 추출 (URL 전체에서 ID만 정확히 파싱)
                    // 정규식: (v=... 또는 youtu.be/...) 다음에 오는 비디오 ID (특수문자 포함)
                    const regex = /(?:v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
                    const match = todayLine.match(regex);
                    if (match && match[1]) {
                        videoId = match[1];
                        initializePlayer();
                    } else {
                        throw new Error('오늘 날짜의 오디오 주소 형식이 올바르지 않습니다.');
                    }
                } else {
                    // 오늘 날짜의 주소가 없는 경우
                    showError('오늘의 AI요약 음성은 아직 업로드 전입니다.');
                }
            } catch (error) {
                console.error('Error fetching audio address:', error);
                showError(error.message || '오디오를 불러오는 중 오류가 발생했습니다.');
            }
        }

        // 4. 오늘 날짜 포맷 (MMDD)
        function getFormattedDate() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            // return `${month}${day}`;
            return '1110'; // 요청된 날짜로 고정
        }

        // 5. 플레이어 초기화
        function initializePlayer() {
            player = new YT.Player('player-container', {
                height: '1',
                width: '1',
                videoId: videoId,
                playerVars: {
                    'playsinline': 1,
                    'controls': 0,
                    'showinfo': 0,
                    'rel': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 6. 플레이어 준비 완료
        function onPlayerReady(event) {
            isPlayerReady = true;
            audioButton.disabled = false;
            buttonText.textContent = 'AI요약 듣기';
            audioButton.setAttribute('aria-label', '교리 오디오 재생');
            audioButton.addEventListener('click', togglePlayPause);
        }

        // 7. 플레이어 상태 변경
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updateButtonUI(true);
            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                updateButtonUI(false);
                if (event.data === YT.PlayerState.ENDED) {
                    player.seekTo(0); // 끝나면 처음으로 되감기
                }
            }
        }

        // 8. 재생/일시정지 토글
        function togglePlayPause() {
            if (!isPlayerReady) return;
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        // 9. 버튼 UI 업데이트
        function updateButtonUI(playing) {
            if (playing) {
                audioButton.classList.remove('play');
                audioButton.classList.add('pause');
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'inline';
                buttonText.textContent = '일시정지';
                audioButton.setAttribute('aria-label', '교리 오디오 일시정지');
            } else {
                audioButton.classList.remove('pause');
                audioButton.classList.add('play');
                playIcon.style.display = 'inline';
                pauseIcon.style.display = 'none';
                buttonText.textContent = 'AI요약 듣기';
                audioButton.setAttribute('aria-label', '교리 오디오 재생');
            }
        }

        // 10. 오류 처리
        function showError(message) {
            // 기존 UI 숨기기
            const button = document.getElementById('audio-button');
            if (button) {
                button.style.display = 'none';
            }
            
            // 오류 메시지 표시
            errorContainer.textContent = message;
            errorContainer.style.display = 'block';
        }

        // API 로드 시작
        loadYouTubeAPI();
    </script>

</body>
</html>
