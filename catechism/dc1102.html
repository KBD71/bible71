<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>날마다 읽는 교리 - 11월 2일</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" as="style" crossorigin="anonymous" />
    <style>
        body {
            font-family: "Pretendard", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            word-break: keep-all;
            background-color: #f3f4f6; /* Tailwind gray-100 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* lg */
            margin-bottom: 1.5rem; /* 6 */
            overflow: hidden;
        }
        .card-header {
            background-color: #4a5568; /* Tailwind gray-700 */
            color: white;
            padding: 1rem 1.5rem;
            font-size: 1.25rem; /* xl */
            font-weight: 700;
            border-bottom: 1px solid #e5e7eb; /* gray-200 */
        }
        .card-body {
            padding: 1.5rem;
            line-height: 1.75;
        }
        .card-body h3 {
            font-size: 1.125rem; /* lg */
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #1f2937; /* gray-800 */
        }
        .card-body p {
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body li {
            margin-bottom: 0.5rem;
        }
        .card-body .question {
            font-weight: 600;
            color: #111827; /* gray-900 */
        }
        .card-body .answer {
            color: #374151; /* gray-700 */
        }
        .audio-player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            background-color: #f9fafb; /* gray-50 */
            border-top: 1px solid #e5e7eb; /* gray-200 */
        }
        .audio-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
        }
        .audio-button:disabled {
            background-color: #e5e7eb; /* gray-200 */
            color: #9ca3af; /* gray-400 */
            cursor: not-allowed;
        }
        .audio-button.play {
            background-color: #2563eb; /* blue-600 */
            color: white;
        }
        .audio-button.play:hover {
            background-color: #1d4ed8; /* blue-700 */
        }
        .audio-button.pause {
            background-color: #f87171; /* red-400 */
            color: white;
        }
        .audio-button.pause:hover {
            background-color: #ef4444; /* red-500 */
        }
        .audio-error {
            color: #dc2626; /* red-600 */
            font-weight: 500;
            text-align: center;
        }
        #player-container {
            width: 1px;
            height: 1px;
            opacity: 0;
            position: absolute;
            top: -100px;
            left: -100px;
        }
        footer {
            text-align: center;
            padding: 2rem 1rem;
            font-size: 0.875rem; /* sm */
            color: #6b7280; /* gray-500 */
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto max-w-3xl px-4 py-8 sm:py-12">

        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-gray-800">11월 2일</h1>
            <p class="text-xl text-gray-600 mt-2">그리스도의 구속의 유익을 전달하는 외적 수단들</p>
        </header>

        <main>
            <div class="card">
                <div class="card-header">
                    AI요약 듣기
                </div>
                <div class="audio-player-container" id="audio-player-ui">
                    <div id="player-container"></div>
                    <button id="audio-button" class="audio-button play" aria-label="교리 오디오 재생" disabled>
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2">
                            <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2" style="display: none;">
                            <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z" clip-rule="evenodd" />
                        </svg>
                        <span id="button-text">로딩 중...</span>
                    </button>
                    <div id="audio-error" class="audio-error mt-4" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    소요리문답 88문
                </div>
                <div class="card-body">
                    <div class="question-answer">
                        <p class="question">문88. 그리스도께서 구속의 유익을 우리에게 전하시는 외적이고 통상적인 수단들은 무엇입니까?</p>
                        <p class="answer">답. 그리스도께서 구속의 유익을 우리에게 전달하시는 외적이고 통상적인 수단들은 그분의 규례인데, 특히 말씀과 성례와 기도입니다. 이 모든 것은 택함을 받은 자들이 구원받는 데 효과적입니다.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    대요리문답 154문
                </div>
                <div class="card-body">
                    <div class="question-answer">
                        <p class="question">문154. 그리스도께서 중보의 유익을 우리에게 전달하시는 외적 수단들은 무엇입니까?</p>
                        <p class="answer">답. 그리스도께서 중보의 유익을 우리에게 전달하시는 외적이고 통상적인 수단은 그분의 모든 규례인데, 특히 말씀과 성례와 기도입니다. 이 모든 것은 택함을 받은 자들이 구원을 얻는 데 효과적입니다.</EOM>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    교리 해설
                </div>
                <div class="card-body">
                    [cite_start]<p>그리스도의 구속의 유익을 전달하는 수단을 <strong class="text-blue-600">'은혜의 수단'</strong>이라고 일컫습니다[cite: 128]. [cite_start]그리스도께서 이루신 구속의 은택이 우리에게 적용될 수 있도록 정하신 방편입니다[cite: 130]. 오늘 소요리문답 88항과 대요리문답 154항은 동일한 내용을 다루므로, 대요리문답의 진술을 세 가지로 나누어 살펴보겠습니다.</p>

                    <h3>1. "외적이고 통상적인 수단"</h3>
                    [cite_start]<p>어제 살핀 것처럼, 은혜의 수단은 <strong class="text-blue-600">"외적"</strong>입니다[cite: 134]. [cite_start]이는 말씀을 읽고 듣거나, 물로 세례를 받고 빵과 포도주로 성찬을 받거나, 소리내어 기도하는 것처럼 우리의 몸과 감각을 매개로 사용하는 가시적인 특징을 말합니다[cite: 135]. [cite_start]외적인 특성 때문에 형식주의에 빠질 위험이 있으며, 오직 <strong class="text-blue-600">성령께서 내적으로 역사하실 때, "믿음으로" 참여할 때라야</strong> 은혜가 전달됩니다[cite: 141, 142].</p>
                    [cite_start]<p><strong class="text-blue-600">"통상적인 수단"</strong>이라는 말은 보편 교회가 "공통적으로", "표준적으로" 행하는 수단임을 뜻합니다[cite: 142]. [cite_start]어느 시대나 교회나 임의로 은혜의 수단을 만들 수 없으며, 그리스도께서 제정하신 방식을 표준으로 삼아 질서 있게 행해야 합니다[cite: 142]. [cite_start]교회가 공적 예배를 통해 말씀을 바르게 강설하고, 성례를 성경의 규례대로 시행하며, 기도를 합당하게 드릴 때, 성도들은 의롭다 하심, 자녀 됨, 거룩함, 양심의 평안과 같은 그리스도의 구속의 유익을 실제로 받아 누리게 됩니다[cite: 142, 143].</p>

                    <h3>2. "그분의 모든 규례인데, 특히 말씀과 성례와 기도입니다."</h3>
                    [cite_start]<p>그리스도께서 제정하신 규례는 말씀, 성례, 기도만이 아닙니다[cite: 144]. [cite_start]찬송, 직분자 임명, 권징, 전도와 교육 등 교회가 예배와 복음 사역을 위해 행하도록 명령하신 모든 것이 그리스도의 규례입니다[cite: 145, 146].</p>
                    [cite_start]<p>대요리문답은 이 모든 규례 가운데 <strong class="text-blue-600">특히 "말씀과 성례와 기도"</strong>를 대표적인 은혜의 수단으로 말합니다[cite: 147, 148]. [cite_start]이 중 <strong class="text-blue-600">"말씀"은 가장 기본적이며 핵심</strong>입니다[cite: 148]. [cite_start]"믿음은 들음에서 나기"(롬 10:17) 때문입니다[cite: 149]. 말씀이 없다면 다른 은혜의 수단은 전할 내용이 사라집니다. [cite_start]성례는 말씀으로 전달된 복음을 강화하며, 기도는 말씀을 통해 주어진 교훈을 따라 행해야 하기 때문입니다[cite: 150, 151].</p>

                    <h3>3. "택함을 받은 자들이 구원을 얻는 데 효과적입니다"</h3>
                    <p>이 진술은 두 가지 사항을 강조합니다. [cite_start]첫째, 말씀, 성례, 기도와 같은 규례들은 비록 외적이지만 구원을 얻는 데 <strong class="text-blue-600">"효과적"</strong>이라는 점입니다[cite: 153]. [cite_start]둘째, 이 수단들은 <strong class="text-blue-600">"택함을 받은 자들"에게만 효과적</strong>이라는 점입니다[cite: 154].</p>
                    [cite_start]<p>이 규례들은 그 자체로 구원을 주는 능력을 가졌거나(롬 2:28-29) [cite: 156][cite_start], 단지 참여한다고 자동적으로 효과를 일으키지 않습니다[cite: 156]. [cite_start]그럼에도 이 규례들은 하나님께서 구원의 유익이 전달되도록 <strong class="text-blue-600">친히 제정하셨다</strong>는 사실에서 효과성의 근거를 갖습니다(마 28:19-20)[cite: 157, 158]. [cite_start]사람은 스스로 은혜의 수단을 고안해서는 안 됩니다[cite: 159].</p>
                    [cite_start]<p>이 외적 수단이 참된 은혜를 전달하는 효과를 나타내는 것은 기계적으로 이루어지지 않고, 오직 <strong class="text-blue-600">성령 하나님의 사역</strong>으로 말미암습니다[cite: 165]. [cite_start]성령께서 이 외적 수단들을 사용하셔서 은혜를 전달하시는 것이며, 이 규례에 <strong class="text-blue-600">"믿음으로" 참여하는 것을 전제</strong>합니다(히 4:2)[cite: 166, 167].</p>
                    [cite_start]<p>끝으로, 이 은혜의 수단은 참여하는 모든 사람에게 동일하게 유익을 주는 것이 아니라, 오직 <strong class="text-blue-600">"택함을 받은 자들"</strong>에게만 주어집니다[cite: 170]. [cite_start]은혜는 하나님께서 주권적으로 선택하신 자들 안에서 성령께서 믿음을 일으키시는 일을 통해 전달됩니다(행 13:48)[cite: 170]. [cite_start]인간의 행위가 공로가 되어 은혜를 받는 것이 결코 아닙니다(딛 3:5)[cite: 170]. [cite_start]대요리문답 68항이 이르듯이, 선택받지 못한 자들은 외적으로 부르심을 받을 수는 있으나, 제안된 은혜를 고의로 경멸하기에 결코 그리스도께 참되게 나아오지 못합니다[cite: 172].</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    적용 질문
                </div>
                <div class="card-body">
                    <ul>
                        <li><span class="question">1. 그리스도께서 중보의 유익을 전달하시는 외적이고 통상적인 수단이 무엇인지 여러분은 분명히 알고 있습니까? 그렇다면 여러분은 이 수단들을 얼마나 소중히 여기며, 주일 예배와 개인 경건에서 부지런히 참여하고 있습니까?</span></li>
                        <li><span class="question">2. 말씀, 성례, 기도가 은혜의 수단으로서 외적이지만 효과적이라는 교리를 여러분은 바르게 이해하고 있습니까? 그렇다면 여러분은 단순히 형식적으로 참여하지 않고, 믿음으로 은혜를 받고자 하는 마음으로 말씀을 듣고, 성례에 참여하며, 기도에 힘쓰고 있습니까?</span></li>
                        <li><span class="question">3. 은혜의 수단이 오직 그리스도께서 제정하신 방식에 따라 시행될 때만 의미가 있다는 점을 여러분은 분별하고 있습니까? 그렇다면 여러분은 사람의 전통이나 임의로 만든 방식이 아닌, 그리스도께서 명하신 예배와 규례를 따라 하나님을 예배하고 있습니까?</span></li>
                        <li><span class="question">4. 은혜의 수단이 모든 사람에게 제시되지만, 오직 성령 하나님께서 믿음을 일으키실 때만 택자에게 효과적이라는 사실을 여러분은 깨닫고 있습니까? 그렇다면 여러분은 우리의 구원이 전적으로 하나님의 은혜임을 인정하며, 성령께서 우리의 마음에 믿음을 주시기를 간절히 구하고 있습니까?</span></li>
                    </ul>
                </div>
            </div>
        </main>

        <footer>
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        let player;
        let videoId = null;
        let isPlayerReady = false;
        let isPlaying = false;
        const audioButton = document.getElementById('audio-button');
        const buttonText = document.getElementById('button-text');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const errorContainer = document.getElementById('audio-error');
        const playerUi = document.getElementById('audio-player-ui');

        // 1. YouTube API 로드
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // 2. API 콜백 함수
        function onYouTubeIframeAPIReady() {
            fetchAudioAddress();
        }

        // 3. 오디오 주소 fetch 및 파싱
        async function fetchAudioAddress() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('오디오 목록 파일을 불러오는 데 실패했습니다.');
                }
                const text = await response.text();
                const lines = text.split('\n');
                const today = getFormattedDate();
                const todayLine = lines.find(line => line.startsWith(today));

                if (todayLine) {
                    // 비디오 ID 추출 (URL 전체에서 ID만 정확히 파싱)
                    // 정규식: (v=... 또는 youtu.be/...) 다음에 오는 비디오 ID (특수문자 포함)
                    const regex = /(?:v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
                    const match = todayLine.match(regex);
                    if (match && match[1]) {
                        videoId = match[1];
                        initializePlayer();
                    } else {
                        throw new Error('오늘 날짜의 오디오 주소 형식이 올바르지 않습니다.');
                    }
                } else {
                    // 오늘 날짜의 주소가 없는 경우
                    showError('오늘의 AI요약 음성은 아직 업로드 전입니다.');
                }
            } catch (error) {
                console.error('Error fetching audio address:', error);
                showError(error.message || '오디오를 불러오는 중 오류가 발생했습니다.');
            }
        }

        // 4. 오늘 날짜 포맷 (MMDD)
        function getFormattedDate() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            // return `${month}${day}`;
            return '1102'; // 요청된 날짜로 고정
        }

        // 5. 플레이어 초기화
        function initializePlayer() {
            player = new YT.Player('player-container', {
                height: '1',
                width: '1',
                videoId: videoId,
                playerVars: {
                    'playsinline': 1,
                    'controls': 0,
                    'showinfo': 0,
                    'rel': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 6. 플레이어 준비 완료
        function onPlayerReady(event) {
            isPlayerReady = true;
            audioButton.disabled = false;
            buttonText.textContent = 'AI요약 듣기';
            audioButton.setAttribute('aria-label', '교리 오디오 재생');
            audioButton.addEventListener('click', togglePlayPause);
        }

        // 7. 플레이어 상태 변경
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updateButtonUI(true);
            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                updateButtonUI(false);
                if (event.data === YT.PlayerState.ENDED) {
                    player.seekTo(0); // 끝나면 처음으로 되감기
                }
            }
        }

        // 8. 재생/일시정지 토글
        function togglePlayPause() {
            if (!isPlayerReady) return;
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        // 9. 버튼 UI 업데이트
        function updateButtonUI(playing) {
            if (playing) {
                audioButton.classList.remove('play');
                audioButton.classList.add('pause');
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'inline';
                buttonText.textContent = '일시정지';
                audioButton.setAttribute('aria-label', '교리 오디오 일시정지');
            } else {
                audioButton.classList.remove('pause');
                audioButton.classList.add('play');
                playIcon.style.display = 'inline';
                pauseIcon.style.display = 'none';
                buttonText.textContent = 'AI요약 듣기';
                audioButton.setAttribute('aria-label', '교리 오디오 재생');
            }
        }

        // 10. 오류 처리
        function showError(message) {
            // 기존 UI 숨기기
            const button = document.getElementById('audio-button');
            if (button) {
                button.style.display = 'none';
            }
            
            // 오류 메시지 표시
            errorContainer.textContent = message;
            errorContainer.style.display = 'block';
        }

        // API 로드 시작
        loadYouTubeAPI();
    </script>

</body>
</html>
