<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11월 3일 | 구원을 효과 있게 하는 말씀</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto max-w-4xl px-4 py-8">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">11월 3일</h1>
            <p class="text-xl text-gray-600 mt-2">구원을 효과 있게 하는 말씀</p>
        </header>

        <section id="audio-player-section" class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4">AI요약 듣기</h2>
            <div id="player-ui" class="flex items-center space-x-4">
                <button id="play-pause-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full w-28 transition-opacity duration-300" aria-label="교리 오디오 재생/일시정지" disabled>
                    로딩 중...
                </button>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            <div id="player" class="hidden"></div>
            <div id="error-message" class="hidden text-red-500 mt-4"></div>
            <p class="mt-4 text-sm text-gray-500">
                오늘의 자료는 유튜브 영상입니다. '재생' 버튼을 누르면 영상의 음성이 재생됩니다.<br>
                영상 URL: <a href="https://www.youtube.com/watch?v=tzVhOe-sOTk" target="_blank" class="text-blue-600 hover:underline">https://www.youtube.com/watch?v=tzVhOe-sOTk</a>
            </p>
        </section>
        
        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">소요리문답 89문 (주제)</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p><strong class="font-bold">문:</strong> 말씀이 어떻게 구원에 이르게 하는 효과적인 수단이 됩니까?</p>
                <p><strong class="font-bold">답:</strong> 말씀 자체의 힘이 아니라, 성령 하나님께서 말씀을 읽고 듣는 자들에게 적용하사, 죄를 깨닫게 하시고(조명), 회개시키며, 그리스도를 믿게 하시고, 또한 거룩함과 위로로써 그들을 굳게 세워 구원에 이르게 하십니다.</p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md mb-6">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">교리 해설</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>
                    말씀이 구원에 이르는 효과를 발휘하는 것은, 말씀이라는 글자 자체에 마법적인 힘이 있어서가 아닙니다. 그 비밀은 전적으로 <strong class="text-blue-600">성령 하나님</strong>께서 그 말씀을 효과적인 수단으로 '사용'하시는 데에 있습니다. 성령께서는 씨앗이 잘 자라도록 마음밭을 부드럽게 하시는 것처럼, 말씀을 가지고 우리를 구원으로 이끄십니다.
                </p>
                <p>
                    이 과정은 여러 단계로 이루어집니다.
                </p>
                <ul class="list-disc list-inside space-y-4 pl-4">
                    <li>
                        <strong class="text-blue-600">조명(Illumination):</strong> 성령께서는 먼저 죄 때문에 어두워진 우리의 마음을 밝혀, 이전에는 보지 못했던 영적인 실체를 보게 하십니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">죄의 깨달음 (Conviction):</strong> 이 빛 앞에서 우리는 비로소 '내가 죄인이구나'하는 자신의 상태를 깨닫고 죄책을 느끼게 됩니다. 이는 '생명에 이르는 회개'의 시작점입니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">겸손 (Humility):</strong> 자신의 죄를 깨달은 사람은 '나는 아무것도 할 수 없구나'하는 깊은 겸손에 이르게 되며, 자신의 노력이나 의를 내려놓게 됩니다.
                    </li>
                    <li>
                        <strong class="text-blue-600">믿음 (Faith):</strong> 바로 이 지점에서 성령께서는 우리를 자기 자신에게서 끌어내어, 유일한 소망이신 <strong class="text-blue-600">그리스도</strong>께로 나아가도록 이끄십니다. 그분을 받아들이고 전적으로 의지하게 만드시는 것, 이것이 구원 얻는 믿음의 핵심입니다.
                    </li>
                </ul>
                <p>
                    결국 <strong class="text-blue-600">회개</strong>와 <strong class="text-blue-600">믿음</strong>은 별개의 사건이 아니라, 성령께서 말씀을 통해 이끄시는 하나의 과정 속에서 나타나는 동전의 양면과 같습니다.
                </p>
                <p>
                    구원은 신분이 바뀌는 것에서 끝나지 않습니다. 성령께서는 계속해서 말씀을 통해 우리를 <strong class="text-blue-600">성화(Sanctification)</strong>시키십니다. 즉, 우리를 그리스도의 형상을 닮아가도록 변화시키고 그분의 뜻에 복종하도록 이끄십니다. 또한 말씀은 우리가 죄의 유혹과 싸울 힘을 주는 방패가 되며, 우리를 은혜 안에서 자라게 하고 거룩함과 위로 가운데 굳건히 서도록 붙들어 주십니다.
                </p>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold mb-4 text-blue-800">적용 질문</h2>
            <div class="space-y-4 text-lg leading-relaxed">
                <p>만약 성령 하나님께서 말씀을 통해 이렇게 역동적으로 우리의 구원과 성장을 위해 지금도 일하고 계신다면, 우리는 지금 말씀을 어떤 태도로 대하고 있는지 돌아봐야 하지 않을까요? 그냥 정보를 얻거나 뭐 종교적인 의무감으로 읽는 것을 넘어서요. 매 순간 성령님의 조명하심과 인도하심을 구하면서, 이 말씀이 정말 내 생각과 삶을 실제로 변화시킬 수 있다는 그런 기대를 품고 펼치고 있는지 한번 진지하게 자문해 볼 필요가 있겠습니다.</p>
            </div>
        </section>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        let player;
        let progressInterval;
        const playPauseButton = document.getElementById('play-pause-button');
        const progressBar = document.getElementById('progress-bar');
        const errorMessageDiv = document.getElementById('error-message');
        const playerUi = document.getElementById('player-ui');
        
        // 11월 3일 자료는 제공된 유튜브 링크 ID를 직접 사용합니다.
        const videoIdForToday = 'tzVhOe-sOTk';

        function onYouTubeIframeAPIReady() {
            // txt 파일 로드 대신 직접 ID로 플레이어 생성
            try {
                if (!videoIdForToday) {
                    throw new Error('No video ID specified.');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoIdForToday,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                console.error('Error creating player:', error);
            }
        }

        // dcaddr.txt 파일을 로드하는 함수 (참고용으로 남겨둠)
        async function loadVideoForToday_fromFile() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('Audio address file could not be loaded.');
                }
                const data = await response.text();
                const lines = data.split('\n');
                
                const todayKey = '1103'; // 키는 1103으로 설정

                // '1103'로 시작하는 줄을 찾습니다 (공백이나 '=' 모두 처리).
                const todayLine = lines.find(line => line.trim().startsWith(todayKey));
                
                if (!todayLine) {
                    throw new Error('not_uploaded');
                }

                // 날짜(키) 부분을 제외하고 나머지(URL)를 추출합니다.
                let url = todayLine.substring(todayKey.length).trim();
                // 맨 앞에 '=' 문자가 있다면 제거합니다.
                if (url.startsWith('=')) {
                    url = url.substring(1).trim();
                }

                const videoId = extractVideoID(url);

                if (!videoId) {
                    throw new Error('Invalid YouTube URL in dcaddr.txt');
                }
                
                player = new YT.Player('player', {
                    height: '0',
                    width: '0',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });

            } catch (error) {
                playerUi.classList.add('hidden');
                errorMessageDiv.classList.remove('hidden');
                if (error.message === 'not_uploaded') {
                    errorMessageDiv.textContent = '오늘의 AI요약 음성은 아직 업로드 전입니다.';
                } else {
                    errorMessageDiv.textContent = '오디오를 불러오는 중 오류가 발생했습니다.';
                    console.error('Error loading video:', error);
                }
            }
        }

        function extractVideoID(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        function onPlayerReady(event) {
            playPauseButton.disabled = false;
            playPauseButton.textContent = '재생';
            playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
            
            playPauseButton.addEventListener('click', togglePlayPause);
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                playPauseButton.textContent = '일시정지';
                playPauseButton.setAttribute('aria-label', '교리 오디오 일시정지');
                progressInterval = setInterval(updateProgressBar, 1000);
            } else {
                playPauseButton.textContent = '재생';
                playPauseButton.setAttribute('aria-label', '교리 오디오 재생');
                clearInterval(progressInterval);
                if (event.data === YT.PlayerState.ENDED) {
                    progressBar.style.width = '100%';
                }
            }
        }

        function togglePlayPause() {
            if (player.getPlayerState() === YT.PlayerState.PLAYING) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        function updateProgressBar() {
            if (player && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (currentTime / duration) * 100;
                progressBar.style.width = progress + '%';
            }
        }
    </script>

</body>
</html>
