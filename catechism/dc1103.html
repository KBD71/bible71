<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>날마다 읽는 교리 - 11월 3일</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" as="style" crossorigin="anonymous" />
    <style>
        body {
            font-family: "Pretendard", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            word-break: keep-all;
            background-color: #f3f4f6; /* Tailwind gray-100 */
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* lg */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* lg */
            margin-bottom: 1.5rem; /* 6 */
            overflow: hidden;
        }
        .card-header {
            background-color: #4a5568; /* Tailwind gray-700 */
            color: white;
            padding: 1rem 1.5rem;
            font-size: 1.25rem; /* xl */
            font-weight: 700;
            border-bottom: 1px solid #e5e7eb; /* gray-200 */
        }
        .card-body {
            padding: 1.5rem;
            line-height: 1.75;
        }
        .card-body h3 {
            font-size: 1.125rem; /* lg */
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #1f2937; /* gray-800 */
        }
        .card-body p {
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            color: #374151; /* gray-700 */
        }
        .card-body li {
            margin-bottom: 0.5rem;
        }
        .card-body .question {
            font-weight: 600;
            color: #111827; /* gray-900 */
        }
        .card-body .answer {
            color: #374151; /* gray-700 */
        }
        .audio-player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            background-color: #f9fafb; /* gray-50 */
            border-top: 1px solid #e5e7eb; /* gray-200 */
        }
        .audio-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 500;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
            border: 1px solid transparent;
        }
        .audio-button:disabled {
            background-color: #e5e7eb; /* gray-200 */
            color: #9ca3af; /* gray-400 */
            cursor: not-allowed;
        }
        .audio-button.play {
            background-color: #2563eb; /* blue-600 */
            color: white;
        }
        .audio-button.play:hover {
            background-color: #1d4ed8; /* blue-700 */
        }
        .audio-button.pause {
            background-color: #f87171; /* red-400 */
            color: white;
        }
        .audio-button.pause:hover {
            background-color: #ef4444; /* red-500 */
        }
        .audio-error {
            color: #dc2626; /* red-600 */
            font-weight: 500;
            text-align: center;
        }
        #player-container {
            width: 1px;
            height: 1px;
            opacity: 0;
            position: absolute;
            top: -100px;
            left: -100px;
        }
        footer {
            text-align: center;
            padding: 2rem 1rem;
            font-size: 0.875rem; /* sm */
            color: #6b7280; /* gray-500 */
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto max-w-3xl px-4 py-8 sm:py-12">

        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-gray-800">11월 3일</h1>
            <p class="text-xl text-gray-600 mt-2">구원을 효과 있게 하는 말씀</p>
        </header>

        <main>
            <div class="card">
                <div class="card-header">
                    AI요약 듣기
                </div>
                <div class="audio-player-container" id="audio-player-ui">
                    <div id="player-container"></div>
                    <button id="audio-button" class="audio-button play" aria-label="교리 오디오 재생" disabled>
                        <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2">
                            <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
                        </svg>
                        <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2" style="display: none;">
                            <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z" clip-rule="evenodd" />
                        </svg>
                        <span id="button-text">로딩 중...</span>
                    </button>
                    <div id="audio-error" class="audio-error mt-4" style="display: none;"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    소요리문답 89문
                </div>
                <div class="card-body">
                    <div class="question-answer">
                        <p class="question">문89. 말씀이 어떻게 구원을 얻는 데 효과 있게 됩니까?</p>
                        <p class="answer">답. 성령 하나님께서는 말씀을 읽는 것, 특별히 말씀의 선포를 효과 있는 수단으로 사용하셔서, 죄책을 드러내시고 죄인을 회개시키시고, 믿음을 통해 거룩함과 위로 가운데 굳게 세우셔서 구원에 이르게 하십니다.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    대요리문답 155문
                </div>
                <div class="card-body">
                    <div class="question-answer">
                        <p class="question">문155. 말씀이 어떻게 구원을 얻는 데 효과 있게 됩니까?</p>
                        <p class="answer">답. 성령 하나님께서는 말씀을 읽는 것, 특별히 말씀의 선포를 효과 있는 수단으로 사용하셔서, 죄인들의 마음을 밝히시고 죄책을 드러내시며 겸손하게 하시고, 이들을 자신에게서 끌어내 그리스도에게로 나아가도록 하시고, 그리스도의 형상을 본받게 하시며 그분의 뜻에 복종하게 하시고, 이들이 유혹과 부패에 빠지지 않도록 강하게 하시며, 은혜 안에서 자라게 하시고, 믿음을 통해 이들의 마음을 거룩함과 위로 가운데 굳게 세우셔서 구원에 이르게 하십니다.</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    교리 해설
                </div>
                <div class="card-body">
                    <p>어제 우리는 은혜의 수단(말씀, 성례, 기도)이 택함 받은 자들에게 구원을 얻는 데 효과적임을 배웠습니다. 오늘 소요리문답 89항과 대요리문답 155항은 구체적으로 '말씀'이 어떻게 그 효과를 내는지를 다룹니다. 대요리문답을 중심으로 세 부분으로 나누어 살펴보겠습니다.</p>

                    <h3>1. 성령 하나님께서 말씀을 "효과 있는 수단으로 사용하심"</h3>
                    [cite_start]<p>말씀 선포가 은혜의 수단이지만, 선포된 말씀 자체가 자동적으로 은혜를 전달하지는 않습니다. [cite: 230] [cite_start]동일한 말씀을 듣고도 반응이 다른 것은, 말씀 선포가 듣는 자에게 효과를 나타내는 것이 <strong class="text-blue-600">"성령 하나님"의 사역</strong>이기 때문입니다. [cite: 231-233] [cite_start]성경이 하나님의 영감으로 기록되었듯이, 기록된 성경을 읽고 깨닫는 일 또한 성령 하나님의 사역, 곧 <strong class="text-blue-600">'조명의 은혜'</strong>로 이루어집니다. [cite: 241-242] [cite_start]개혁교회는 성령께서 "말씀을 가지고 또는 함께"(Cum Verbo) 사역하신다고 고백하며(살전 1:5), 성경이 하나님의 말씀임을 온전히 설득하시는 분도 오직 성령 하나님이심을 믿습니다. [cite: 239, 242]</p>

                    <h3>2. 성령께서 말씀을 통해 이루시는 일곱 가지 유익</h3>
                    [cite_start]<p>성령 하나님께서 말씀을 수단으로 사용하여 전달하시는 은혜의 유익들은 다음과 같이 일곱 가지 효과로 나타납니다: [cite: 244]</p>
                    <ol class="list-decimal list-inside space-y-2">
                        [cite_start]<li><strong class="text-blue-600">"죄인들의 마음을 밝히심":</strong> 타락 이후 영적 진리에 무지하고 마음이 굳어진(엡 4:18) 자연인은 성령의 일을 깨닫지 못합니다(고전 2:14). [cite: 245-246, 252] [cite_start]성령께서 먼저 마음을 밝히셔야만 선포된 말씀을 깨달을 수 있습니다. [cite: 254]</li>
                        [cite_start]<li><strong class="text-blue-600">"죄책을 드러내심":</strong> 마음이 밝혀진 죄인은 말씀(율법) 앞에서 자신의 죄를 보고 양심의 찔림을 받습니다. [cite: 255-256]</li>
                        [cite_start]<li><strong class="text-blue-600">"겸손하게 하심":</strong> 자신의 죄와 심판을 알게 된 죄인은 교만이 무너지고, 하나님의 긍휼만을 바라는 겸손한 마음으로 통회하며 무릎 꿇게 됩니다. [cite: 257-258]</li>
                        [cite_start]<li><strong class="text-blue-600">"자신에게서 끌어내 그리스도에게로 나아가도록 하심":</strong> 죄인은 더 이상 자신의 의나 공로가 아닌, 오직 그리스도만이 구원의 소망임을 고백하고 그분께 나아갑니다(요 6:44). [cite: 258]</li>
                        <li><strong class="text-blue-600">"그리스도의 형상을 본받게 하시며 그분의 뜻에 복종하게 하심":</strong> 이는 신분적 변화(칭의)에 머무르지 않고, 거룩한 상태로의 변화(<strong class="text-blue-600">성화</strong>)로 나아가는 것입니다. [cite_start]신앙고백서 13.1은 성령께서 "말씀"을 수단으로 사용하셔서 성화를 이루어 가심을 명확히 밝힙니다. [cite: 259-260]</li>
                        [cite_start]<li><strong class="text-blue-600">"유혹과 부패에 빠지지 않도록 강하게 하심":</strong> 성령의 은혜로 말씀은 죄의 욕정을 약화시키고(신앙고백서 13.1), [cite: 260] 말씀을 가까이할 때 유혹에 대한 대항력은 강화됩니다.</li>
                        [cite_start]<li><strong class="text-blue-600">"은혜 안에서 자라게 하시고... 거룩함과 위로 가운데 굳게 세우심":</strong> 이 모든 유익은 오직 성령의 은혜로 이루어집니다. [cite: 261] [cite_start]말씀은 성도에게 죄 사함과 영광의 소망을 바라보게 하여 거룩한 삶을 인내하도록 <strong class="text-blue-600">위로</strong>합니다. [cite: 261]</li>
                    </ol>

                    <h3>3. "구원에 이르게 하심"</h3>
                    [cite_start]<p>성령께서는 말씀을 사용하여 앞서 언급한 일곱 가지 영적 유익을 이루시고, 그 결과로 신자를 <strong class="text-blue-600">"구원에 이르게 하신다"</strong>고 진술합니다. [cite: 263] [cite_start]말씀은 단순한 지식 전달이 아니라, 성령께서 실제로 구원에 이르도록 역사하시는 수단입니다. [cite: 264]</p>
                    [cite_start]<p>구원은 그리스도를 믿는 <strong class="text-blue-600">믿음</strong>으로 주어지며, 이 믿음은 성령께서 행하시는 은혜입니다. [cite: 271] [cite_start]그리고 성령께서는 "통상적으로 말씀 사역에 의해" 이 믿음의 은혜를 이루십니다(신앙고백서 14.1). [cite: 270, 272] [cite_start]즉, 말씀은 구원을 붙드는 믿음을 창조하고 강화하는 수단입니다. [cite: 273] [cite_start]성령께서 구원의 은혜(믿음, 회개)를 이루실 때 통상적으로 하나님의 말씀을 수단으로 사용하신다는 것은 개혁교회 신앙의 가장 핵심적인 고백 중 하나입니다. [cite: 274-277]</p>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    적용 질문
                </div>
                <div class="card-body">
                    <ul>
                        <li><span class="question">1. 성령 하나님께서 말씀이 효과 있게 역사하시지 않는다면 왜 동일한 설교를 들어도 사람마다 전혀 다른 반응을 보이는 것입니까? 여러분은 말씀을 단순한 지식이나 교양으로 받아들이는 것이 아니라, 성령 하나님의 조명하심을 구하며 그분의 은혜 가운데 말씀을 깨닫고 믿음으로 반응하고 있습니까?</span></li>
                        <li><span class="question">2. 성령 하나님께서 말씀을 통해 죄인을 어떻게 겸손하게 하시며, 왜 이것이 회개와 복음으로 나아가는 출발점이 됩니까? 여러분은 말씀을 들을 때마다 자신을 의롭다 여기던 교만을 버리고, 죄인으로서 하나님 앞에 무릎 꿇으며 긍휼을 간구하는 겸손으로 나아가고 있습니까?</span></li>
                        <li><span class="question">3. 성령 하나님께서 죄인을 자신에게서 끌어내어 오직 그리스도께로 나아가게 하신다는 것은 어떤 의미입니까? 여러분은 여전히 자신이 쌓은 의나 공로를 붙드는 것이 아니라, 오직 그리스도만을 구원의 소망으로 의지하며 그분께 나아가고 있습니까?</span></li>
                        <li><span class="question">4. 말씀이 성도를 유혹과 부패에서 지켜내며, 은혜 안에서 자라게 하여 거룩함과 위로 가운데 굳게 세운다는 것은 어떤 방식으로 이루어집니까? 여러분은 말씀을 꾸준히 가까이하며, 그 말씀 안에서 죄와 싸우는 힘과 장차 누릴 영광의 소망을 얻어 실제로 거룩함과 위로 가운데 굳게 서고 있습니까?</span></li>
                    </ul>
                </div>
            </div>
        </main>

        <footer>
            <p>교재는 날마다 양식으로 읽는 웨스트민스터 표준교리(영음사)를 사용합니다</p>
        </footer>

    </div>

    <script>
        let player;
        let videoId = null;
        let isPlayerReady = false;
        let isPlaying = false;
        const audioButton = document.getElementById('audio-button');
        const buttonText = document.getElementById('button-text');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const errorContainer = document.getElementById('audio-error');
        const playerUi = document.getElementById('audio-player-ui');

        // 1. YouTube API 로드
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // 2. API 콜백 함수
        function onYouTubeIframeAPIReady() {
            fetchAudioAddress();
        }

        // 3. 오디오 주소 fetch 및 파싱
        async function fetchAudioAddress() {
            try {
                const response = await fetch('../address/dcaddr.txt');
                if (!response.ok) {
                    throw new Error('오디오 목록 파일을 불러오는 데 실패했습니다.');
                }
                const text = await response.text();
                const lines = text.split('\n');
                const today = getFormattedDate();
                const todayLine = lines.find(line => line.startsWith(today));

                if (todayLine) {
                    // 비디오 ID 추출 (URL 전체에서 ID만 정확히 파싱)
                    // 정규식: (v=... 또는 youtu.be/...) 다음에 오는 비디오 ID (특수문자 포함)
                    const regex = /(?:v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/;
                    const match = todayLine.match(regex);
                    if (match && match[1]) {
                        videoId = match[1];
                        initializePlayer();
                    } else {
                        throw new Error('오늘 날짜의 오디오 주소 형식이 올바르지 않습니다.');
                    }
                } else {
                    // 오늘 날짜의 주소가 없는 경우
                    showError('오늘의 AI요약 음성은 아직 업로드 전입니다.');
                }
            } catch (error) {
                console.error('Error fetching audio address:', error);
                showError(error.message || '오디오를 불러오는 중 오류가 발생했습니다.');
            }
        }

        // 4. 오늘 날짜 포맷 (MMDD)
        function getFormattedDate() {
            const now = new Date();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            // return `${month}${day}`;
            return '1103'; // 요청된 날짜로 고정
        }

        // 5. 플레이어 초기화
        function initializePlayer() {
            player = new YT.Player('player-container', {
                height: '1',
                width: '1',
                videoId: videoId,
                playerVars: {
                    'playsinline': 1,
                    'controls': 0,
                    'showinfo': 0,
                    'rel': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 6. 플레이어 준비 완료
        function onPlayerReady(event) {
            isPlayerReady = true;
            audioButton.disabled = false;
            buttonText.textContent = 'AI요약 듣기';
            audioButton.setAttribute('aria-label', '교리 오디오 재생');
            audioButton.addEventListener('click', togglePlayPause);
        }

        // 7. 플레이어 상태 변경
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                updateButtonUI(true);
            } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                updateButtonUI(false);
                if (event.data === YT.PlayerState.ENDED) {
                    player.seekTo(0); // 끝나면 처음으로 되감기
                }
            }
        }

        // 8. 재생/일시정지 토글
        function togglePlayPause() {
            if (!isPlayerReady) return;
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        // 9. 버튼 UI 업데이트
        function updateButtonUI(playing) {
            if (playing) {
                audioButton.classList.remove('play');
                audioButton.classList.add('pause');
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'inline';
                buttonText.textContent = '일시정지';
                audioButton.setAttribute('aria-label', '교리 오디오 일시정지');
            } else {
                audioButton.classList.remove('pause');
                audioButton.classList.add('play');
                playIcon.style.display = 'inline';
                pauseIcon.style.display = 'none';
                buttonText.textContent = 'AI요약 듣기';
                audioButton.setAttribute('aria-label', '교리 오디오 재생');
            }
        }

        // 10. 오류 처리
        function showError(message) {
            // 기존 UI 숨기기
            const button = document.getElementById('audio-button');
            if (button) {
                button.style.display = 'none';
            }
            
            // 오류 메시지 표시
            errorContainer.textContent = message;
            errorContainer.style.display = 'block';
        }

        // API 로드 시작
        loadYouTubeAPI();
    </script>

</body>
</html>
